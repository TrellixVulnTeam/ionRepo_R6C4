!function(){function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(t,e)||r(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"I/3d":function(r,i,u){"use strict";u.d(i,"a",(function(){return Zp}));var a=u("fXoL"),h=u("D0XW"),l=u("HDdC"),p=u("Cfvw"),d=u("LRne"),v=u("JX91"),y=u("7o/Q");function g(){return function(t){return t.lift(new b)}}var b=function(){function t(){c(this,t)}return f(t,[{key:"call",value:function(t,e){return e.subscribe(new m(t))}}]),t}(),m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(n,t);var e=s(n);function n(t){var r;return c(this,n),(r=e.call(this,t)).hasPrev=!1,r}return f(n,[{key:"_next",value:function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}]),n}(y.a),w=u("lJxs"),_=u("Kqap"),I=u("/uUt"),E=u("pLZG"),O=u("pxpQ"),T=u("spgP"),j=u("ofXK"),A=u("Jgta"),N=u("O1h7"),D=u("zIRd"),k=u("q/0M"),S=u("qOnz"),x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function P(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var R,C="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},L=L||{},U=C||self;function M(){}function V(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function q(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var F="closure_uid_"+(1e9*Math.random()>>>0),B=0;function z(t,e,n){return t.call.apply(t.bind,arguments)}function G(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function K(t,e,n){return(K=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?z:G).apply(null,arguments)}function W(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Q(){return Date.now()}function J(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function X(){this.j=this.j,this.i=this.i}X.prototype.j=!1,X.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,F)&&t[F]||(t[F]=++B)}(this)},X.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var $=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Y=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function tt(t){return/^[\s\xa0]*$/.test(t)}var et,nt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function rt(t,e){return-1!=t.indexOf(e)}function it(t,e){return t<e?-1:t>e?1:0}t:{var ot=U.navigator;if(ot){var st=ot.userAgent;if(st){et=st;break t}}et=""}function ut(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function at(t){var e={};for(var n in t)e[n]=t[n];return e}var ct="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ht(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ct.length;o++)n=ct[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ft(t){return ft[" "](t),t}ft[" "]=M;var lt,pt,dt=rt(et,"Opera"),vt=rt(et,"Trident")||rt(et,"MSIE"),yt=rt(et,"Edge"),gt=yt||vt,bt=rt(et,"Gecko")&&!(rt(et.toLowerCase(),"webkit")&&!rt(et,"Edge"))&&!(rt(et,"Trident")||rt(et,"MSIE"))&&!rt(et,"Edge"),mt=rt(et.toLowerCase(),"webkit")&&!rt(et,"Edge");function wt(){var t=U.document;return t?t.documentMode:void 0}t:{var _t="",It=(pt=et,bt?/rv:([^\);]+)(\)|;)/.exec(pt):yt?/Edge\/([\d\.]+)/.exec(pt):vt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pt):mt?/WebKit\/(\S+)/.exec(pt):dt?/(?:Version)[ \/]?(\S+)/.exec(pt):void 0);if(It&&(_t=It?It[1]:""),vt){var Et=wt();if(null!=Et&&Et>parseFloat(_t)){lt=String(Et);break t}}lt=_t}var Ot={};function Tt(t){return function(t,e){var n=Ot;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=nt(String(lt)).split("."),r=nt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=it(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||it(0==s[2].length,0==u[2].length)||it(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}var jt=U.document&&vt&&(wt()||parseInt(lt,10))||void 0,At=!vt||9<=Number(jt),Nt=vt&&!Tt("9"),Dt=function(){if(!U.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{U.addEventListener("test",M,e),U.removeEventListener("test",M,e)}catch(n){}return t}();function kt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function St(t,e){if(kt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(bt){t:{try{ft(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:xt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}kt.prototype.b=function(){this.defaultPrevented=!0},J(St,kt);var xt={2:"touch",3:"pen",4:"mouse"};St.prototype.b=function(){St.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Nt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Pt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function Ct(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Rt,this.Y=this.Z=!1}function Lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ut(t){this.src=t,this.a={},this.b=0}function Mt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=$(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ut.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ct(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var qt="closure_lm_"+(1e6*Math.random()|0),Ft={};function Bt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=$t(r),e&&e[Pt]?e.wa(n,r,q(i)?!!i.capture:!!i,o):zt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Bt(t,e[o],n,r,i);return null}return n=$t(n),t&&t[Pt]?t.va(e,n,q(r)?!!r.capture:!!r,i):zt(t,e,n,!1,r,i)}function zt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=q(i)?!!i.capture:!!i;if(s&&!At)return null;var u=Jt(t);if(u||(t[qt]=u=new Ut(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Qt,e=At?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Dt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Gt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Pt])Mt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Jt(e))?(Mt(n,t),0==n.b&&(n.src=null,e[qt]=null)):Lt(t)}}}function Kt(t){return t in Ft?Ft[t]:Ft[t]="on"+t}function Wt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Gt(t),n.call(r,e)}function Qt(t,e){if(t.Y)return!0;if(!At){if(!e)t:{e=["window","event"];for(var n=U,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Wt(t,e=new St(e,this))}return Wt(t,new St(e,this))}function Jt(t){return(t=t[qt])instanceof Ut?t:null}var Xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function $t(t){return"function"==typeof t?t:(t[Xt]||(t[Xt]=function(e){return t.handleEvent(e)}),t[Xt])}function Yt(){X.call(this),this.c=new Ut(this),this.J=this,this.C=null}function Ht(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new kt(e,t);else if(e instanceof kt)e.target=e.target||t;else{var i=e;ht(e=new kt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Zt(s,r,!0,e)&&i}if(i=Zt(s=e.a=t,r,!0,e)&&i,i=Zt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Zt(s=e.a=n[o],r,!1,e)&&i}function Zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Mt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}J(Yt,X),Yt.prototype[Pt]=!0,(R=Yt.prototype).addEventListener=function(t,e,n,r){Bt(this,t,e,n,r)},R.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=q(i)?!!i.capture:!!i,r=$t(r),e&&e[Pt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Vt(s=e.a[n],r,i,o))&&(Lt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=Jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,r,i,o)),(r=-1<e?n[e]:null)&&Gt(r))}(this,t,e,n,r)},R.G=function(){if(Yt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Lt(n[r]);delete e.a[t],e.b--}}this.C=null},R.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},R.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var te=U.JSON.stringify;function ee(){this.b=this.a=null}var ne,re=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new oe}),(function(t){t.reset()}));function ie(){var t=ce,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function oe(){this.next=this.b=this.a=null}function se(t){U.setTimeout((function(){throw t}),0)}function ue(t,e){ne||function(){var t=U.Promise.resolve(void 0);ne=function(){t.then(he)}}(),ae||(ne(),ae=!0),ce.add(t,e)}ee.prototype.add=function(t,e){var n=re.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},oe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},oe.prototype.reset=function(){this.next=this.b=this.a=null};var ae=!1,ce=new ee;function he(){for(var t;t=ie();){try{t.a.call(t.b)}catch(n){se(n)}var e=re;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ae=!1}function fe(t,e){Yt.call(this),this.b=t||1,this.a=e||U,this.f=K(this.Za,this),this.g=Q()}function le(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function pe(t,e,n){if("function"==typeof t)n&&(t=K(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=K(t.handleEvent,t)}return 2147483647<Number(e)?-1:U.setTimeout(t,e||0)}function de(t){t.a=pe((function(){t.a=null,t.c&&(t.c=!1,de(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}J(fe,Yt),(R=fe.prototype).aa=!1,R.M=null,R.Za=function(){if(this.aa){var t=Q()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ht(this,"tick"),this.aa&&(le(this),this.start()))}},R.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Q())},R.G=function(){fe.X.G.call(this),le(this),delete this.a};var ve=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:de(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(U.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(X);function ye(t){X.call(this),this.b=t,this.a={}}J(ye,X);var ge=[];function be(t,e,n,r){Array.isArray(n)||(n&&(ge[0]=n.toString()),n=ge);for(var i=0;i<n.length;i++){var o=Bt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function me(t){ut(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Gt(t)}),t),t.a={}}function we(){this.a=!0}function _e(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return te(n)}catch(u){return e}}(t,n)+(r?" "+r:"")}))}ye.prototype.G=function(){ye.X.G.call(this),me(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},we.prototype.info=function(){};var Ie={},Ee=null;function Oe(){return Ee=Ee||new Yt}function Te(t){kt.call(this,Ie.Fa,t)}function je(t){var e=Oe();Ht(e,new Te(e,t))}function Ae(t,e){kt.call(this,Ie.STAT_EVENT,t),this.stat=e}function Ne(t){var e=Oe();Ht(e,new Ae(e,t))}function De(t){kt.call(this,Ie.Ga,t)}function ke(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return U.setTimeout((function(){t()}),e)}Ie.Fa="serverreachability",J(Te,kt),Ie.STAT_EVENT="statevent",J(Ae,kt),Ie.Ga="timingevent",J(De,kt);var Se={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},xe={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Pe(){}function Re(){}Pe.prototype.a=null;var Ce,Le={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ue(){kt.call(this,"d")}function Me(){kt.call(this,"c")}function Ve(){}function qe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ye(this),this.P=Fe,this.R=new fe(t=gt?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}J(Ue,kt),J(Me,kt),J(Ve,Pe),Ce=new Ve;var Fe=45e3,Be={},ze={};function Ge(t,e,n){t.H=1,t.i=pn(un(e)),t.j=n,t.I=!0,Ke(t,null)}function Ke(t,e){t.u=Q(),Je(t),t.l=un(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),jn(n.b,"t",r),t.D=0,t.a=wr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ve(K(t.Ca,t,t.a),t.O)),be(t.J,t.a,"readystatechange",t.Xa),e=t.B?at(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),je(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function We(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Qe(t,n);if(i==ze){4==e&&(t.h=4,Ne(14),r=!1),_e(t.c,t.f,null,"[Incomplete Response]");break}if(i==Be){t.h=4,Ne(15),_e(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}_e(t.c,t.f,i,null),Ze(t,i)}4==e&&0==n.length&&(t.h=1,Ne(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),lr(e),e.F=!0,Ne(11))):(_e(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),Ye(t))}function Qe(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ze:(n=Number(e.substring(n,r)),isNaN(n)?Be:(r+=1)+n>e.length?ze:(e=e.substr(r,n),t.D=r+n,e))}function Je(t){t.T=Q()+t.P,Xe(t,t.P)}function Xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ke(K(t.Va,t),e)}function $e(t){t.o&&(U.clearTimeout(t.o),t.o=null)}function Ye(t){0==t.g.v||t.A||vr(t.g,t)}function He(t){$e(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,le(t.R),me(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ze(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Pn(n.b,t)))if(n.I=t.N,!t.C&&Pn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(up){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;dr(n),rr(n)}fr(n),Ne(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ke(K(n.Sa,n),6e3));if(1>=xn(n.b)&&n.ea){try{n.ea()}catch(up){}n.ea=void 0}}else gr(n,11)}else if((t.C||n.a==t)&&dr(n),!tt(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(rt(h,"spdy")||rt(h,"quic")||rt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Rn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,ln(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=Q()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=mr(a,a.C?a.ga:null,a.fa),p.C){Cn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&($e(d),Je(d)),a.a=p}else hr(a);0<n.g.length&&sr(n)}else"stop"!=i[0]&&"close"!=i[0]||gr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?gr(n,7):nr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);je(4)}catch(up){}}function tn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)Y(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function en(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof en)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];rn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)rn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(R=qe.prototype).setTimeout=function(t){this.P=t},R.Xa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},R.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!gt&&!this.a.$())){this.A||4!=e||7==n||je(8==n||0>=r?3:2),$e(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!tt(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ne(12),He(this),Ye(this);break t}_e(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ze(this,a)}this.I?(We(this,e,o),gt&&this.b&&3==e&&(be(this.J,this.R,"tick",this.Wa),this.R.start())):(_e(this.c,this.f,o,null),Ze(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?vr(this.g,this):(this.b=!1,Je(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ne(12)):(this.h=0,Ne(13)),He(this),Ye(this)}}}catch(c){}},R.Wa=function(){if(this.a){var t=Hn(this.a),e=this.a.$();this.D<e.length&&($e(this),We(this,t,e),this.b&&4!=t&&Je(this))}},R.cancel=function(){this.A=!0,He(this)},R.Va=function(){this.o=null;var t=Q();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(je(3),Ne(17)),He(this),this.h=2,Ye(this)):Xe(this,this.T-t)},(R=en.prototype).K=function(){nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},R.L=function(){return nn(this),this.a.concat()},R.get=function(t,e){return rn(this.b,t)?this.b[t]:e},R.set=function(t,e){rn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},R.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var on=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function sn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof sn){this.a=void 0!==e?e:t.a,an(this,t.f),this.j=t.j,cn(this,t.c),hn(this,t.h),this.g=t.g,e=t.b;var n=new In;n.c=e.c,e.a&&(n.a=new en(e.a),n.b=e.b),fn(this,n),this.i=t.i}else t&&(n=String(t).match(on))?(this.a=!!e,an(this,n[1]||"",!0),this.j=dn(n[2]||""),cn(this,n[3]||"",!0),hn(this,n[4]),this.g=dn(n[5]||"",!0),fn(this,n[6]||"",!0),this.i=dn(n[7]||"")):(this.a=!!e,this.b=new In(null,this.a))}function un(t){return new sn(t)}function an(t,e,n){t.f=n?dn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function cn(t,e,n){t.c=n?dn(e,!0):e}function hn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function fn(t,e,n){e instanceof In?(t.b=e,function(t,e){e&&!t.f&&(En(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(On(this,e),jn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=vn(e,wn)),t.b=new In(e,t.a))}function ln(t,e,n){t.b.set(e,n)}function pn(t){return ln(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Q()).toString(36)),t}function dn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,yn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function yn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}sn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(vn(e,gn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(vn(e,gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(vn(n,"/"==n.charAt(0)?mn:bn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",vn(n,_n)),t.join("")};var gn=/[#\/\?@]/g,bn=/[#\?:]/g,mn=/[#\?]/g,wn=/[#\?@]/g,_n=/#/g;function In(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function En(t){t.a||(t.a=new en,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function On(t,e){En(t),e=An(t,e),rn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,rn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&nn(t)))}function Tn(t,e){return En(t),e=An(t,e),rn(t.a.b,e)}function jn(t,e,n){On(t,e),0<n.length&&(t.c=null,t.a.set(An(t,e),Z(n)),t.b+=n.length)}function An(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(R=In.prototype).add=function(t,e){En(this),this.c=null,t=An(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},R.forEach=function(t,e){En(this),this.a.forEach((function(n,r){Y(n,(function(n){t.call(e,n,r,this)}),this)}),this)},R.L=function(){En(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},R.K=function(t){En(this);var e=[];if("string"==typeof t)Tn(this,t)&&(e=H(e,this.a.get(An(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},R.set=function(t,e){return En(this),this.c=null,Tn(this,t=An(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},R.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},R.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Nn=function(t,e){this.b=t,this.a=e};function Dn(t){this.g=t||kn,t=U.PerformanceNavigationTiming?0<(t=U.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(U.ia&&U.ia.ya&&U.ia.ya()&&U.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var kn=10;function Sn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function xn(t){return t.b?1:t.a?t.a.size:0}function Pn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Rn(t,e){t.a?t.a.add(e):t.b=e}function Cn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=P(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Z(t.c)}function Un(){}function Mn(){this.a=new Un}function Vn(t,e,n){var r=n||"";try{tn(t,(function(t,n){var i=t;q(t)&&(i=te(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function qn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Dn.prototype.cancel=function(){var t,e;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=P(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Un.prototype.stringify=function(t){return U.JSON.stringify(t,void 0)},Un.prototype.parse=function(t){return U.JSON.parse(t,void 0)};var Fn=U.JSON.parse;function Bn(t){Yt.call(this),this.headers=new en,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}J(Bn,Yt);var zn="",Gn=/^https?$/i,Kn=["POST","PUT"];function Wn(t){return"content-type"==t.toLowerCase()}function Qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Jn(t),$n(t)}function Jn(t){t.u||(t.u=!0,Ht(t,"complete"),Ht(t,"error"))}function Xn(t){if(t.b&&void 0!==L&&(!t.s[1]||4!=Hn(t)||2!=t.W()))if(t.l&&4==Hn(t))pe(t.za,0,t);else if(Ht(t,"readystatechange"),4==Hn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(on)[1]||null;if(!o&&U.self&&U.self.location){var s=U.self.location.protocol;o=s.substr(0,s.length-1)}i=!Gn.test(o?o.toLowerCase():"")}e=i}if(e)Ht(t,"complete"),Ht(t,"success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(n){u=""}t.f=u+" ["+t.W()+"]",Jn(t)}}finally{$n(t)}}}function $n(t,e){if(t.a){Yn(t);var n=t.a,r=t.s[0]?M:null;t.a=null,t.s=null,e||Ht(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Yn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(U.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return ut(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ln(t,e,n))}function tr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function er(t){this.pa=0,this.g=[],this.c=new we,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=tr("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=tr("baseRetryDelayMs",5e3,t),this.Ra=tr("retryDelaySeedMs",1e4,t),this.Ma=tr("forwardChannelMaxRetries",2,t),this.ma=tr("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Dn(t&&t.concurrentRequestLimit),this.ka=new Mn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function nr(t){if(ir(t),3==t.v){var e=t.R++,n=un(t.B);ln(n,"SID",t.J),ln(n,"RID",e),ln(n,"TYPE","terminate"),ar(t,n),(e=new qe(t,t.c,e,void 0)).H=2,e.i=pn(un(n)),n=!1,U.navigator&&U.navigator.sendBeacon&&(n=U.navigator.sendBeacon(e.i.toString(),"")),!n&&U.Image&&((new Image).src=e.i,n=!0),n||(e.a=wr(e.g,null),e.a.ba(e.i)),e.u=Q(),Je(e)}br(t)}function rr(t){t.a&&(lr(t),t.a.cancel(),t.a=null)}function ir(t){rr(t),t.j&&(U.clearTimeout(t.j),t.j=null),dr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&U.clearTimeout(t.h),t.h=null)}function or(t,e){t.g.push(new Nn(t.Oa++,e)),3==t.v&&sr(t)}function sr(t){Sn(t.b)||t.h||(t.h=!0,ue(t.Ba,t),t.u=0)}function ur(t,e){var n;n=e?e.f:t.R++;var r=un(t.B);ln(r,"SID",t.J),ln(r,"RID",n),ln(r,"AID",t.P),ar(t,r),t.i&&t.l&&Zn(r,t.i,t.l),n=new qe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=cr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Rn(t.b,n),Ge(n,r,e)}function ar(t,e){t.f&&tn({},(function(t,n){ln(e,n,t)}))}function cr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?K(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Vn(h,s,"req"+c+"_")}catch(Hr){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function hr(t){t.a||t.j||(t.T=1,ue(t.Aa,t),t.o=0)}function fr(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=ke(K(t.Aa,t),yr(t,t.o)),t.o++,0))}function lr(t){null!=t.s&&(U.clearTimeout(t.s),t.s=null)}function pr(t){t.a=new qe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=un(t.la);ln(e,"RID","rpc"),ln(e,"SID",t.J),ln(e,"CI",t.H?"0":"1"),ln(e,"AID",t.P),ar(t,e),ln(e,"TYPE","xmlhttp"),t.i&&t.l&&Zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=pn(un(e)),n.j=null,n.I=!0,Ke(n,t)}function dr(t){null!=t.m&&(U.clearTimeout(t.m),t.m=null)}function vr(t,e){var n=null;if(t.a==e){dr(t),lr(t),t.a=null;var r=2}else{if(!Pn(t.b,e))return;n=e.s,Cn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Q()-e.u;var i=t.u;Ht(r=Oe(),new De(r,n,e,i)),sr(t)}else hr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(xn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=ke(K(t.Ba,t,e),yr(t,t.u)),t.u++,0)))}(t,e)||2==r&&fr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:gr(t,5);break;case 4:gr(t,10);break;case 3:gr(t,6);break;default:gr(t,2)}}function yr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function gr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=K(t.Ya,t);n||(n=new sn("//www.google.com/images/cleardot.gif"),U.location&&"http"==U.location.protocol||an(n,"https"),pn(n)),function(t,e){var n=new we;if(U.Image){var r=new Image;r.onload=W(qn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=W(qn,n,r,"TestLoadImage: error",!1,e),r.onabort=W(qn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=W(qn,n,r,"TestLoadImage: timeout",!1,e),U.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ne(2);t.v=0,t.f&&t.f.ra(e),br(t),ir(t)}function br(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,Z(t.g),t.g.length=0),t.f.qa())}function mr(t,e,n){var r=function(t){return t instanceof sn?un(t):new sn(t,void 0)}(n);if(""!=r.c)e&&cn(r,e+"."+r.c),hn(r,r.h);else{var i=U.location;r=function(t,e,n,r){var i=new sn(null,void 0);return t&&an(i,t),e&&cn(i,e),n&&hn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&ut(t.V,(function(t,e){ln(r,e,t)})),n=t.na,(e=t.A)&&n&&ln(r,e,n),ln(r,"VER",t.ha),ar(t,r),r}function wr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Bn(t.Na)).F=t.C,e}function _r(){}function Ir(){if(vt&&!(10<=Number(jt)))throw Error("Environmental error: no available transport.")}function Er(t,e){Yt.call(this),this.a=new er(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!tt(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!tt(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new jr(this)}function Or(t){Ue.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Tr(){Me.call(this),this.status=1}function jr(t){this.a=t}(R=Bn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.H?this.H:Ce),this.a.onreadystatechange=K(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Qn(this,o)}t=n||"";var i=new en(this.headers);r&&tn(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Wn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=U.FormData&&t instanceof U.FormData,!(0<=$(Kn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Yn(this),0<this.o&&((this.D=function(t){return vt&&Tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=K(this.xa,this)):this.m=pe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Qn(this,o)}},R.xa=function(){void 0!==L&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ht(this,"timeout"),this.abort(8))},R.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ht(this,"complete"),Ht(this,"abort"),$n(this))},R.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),$n(this,!0)),Bn.X.G.call(this)},R.za=function(){this.j||(this.A||this.l||this.g?Xn(this):this.Ua())},R.Ua=function(){Xn(this)},R.W=function(){try{return 2<Hn(this)?this.a.status:-1}catch(pt){return-1}},R.$=function(){try{return this.a?this.a.responseText:""}catch(pt){return""}},R.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Fn(e)}},R.ua=function(){return this.h},R.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(R=er.prototype).ha=8,R.v=1,R.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new qe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?ht(r=at(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=cr(this,n,e),ln(i=un(this.B),"RID",t),ln(i,"CVER",22),this.A&&ln(i,"X-HTTP-Session-Id",this.A),ar(this,i),this.i&&r&&Zn(i,this.i,r),Rn(this.b,n),this.Ia&&ln(i,"TYPE","init"),this.da?(ln(i,"$req",e),ln(i,"SID","null"),n.U=!0,Ge(n,i,null)):Ge(n,i,e),this.v=2}}else 3==this.v&&(t?ur(this,t):0==this.g.length||Sn(this.b)||ur(this))},R.Aa=function(){if(this.j=null,pr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ke(K(this.Ta,this),t)}},R.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Ne(10),rr(this),pr(this))},R.Sa=function(){null!=this.m&&(this.m=null,rr(this),fr(this),Ne(19))},R.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Ne(2)):(this.c.info("Failed to ping google.com"),Ne(1))},(R=_r.prototype).ta=function(){},R.sa=function(){},R.ra=function(){},R.qa=function(){},R.Ja=function(){},Ir.prototype.a=function(t,e){return new Er(t,e)},J(Er,Yt),Er.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Ne(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=mr(t,null,t.fa),sr(t)},Er.prototype.close=function(){nr(this.a)},Er.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,or(this.a,e)}else this.l?((e={}).__data__=te(t),or(this.a,e)):or(this.a,t)},Er.prototype.G=function(){this.a.f=null,delete this.f,nr(this.a),delete this.a,Er.X.G.call(this)},J(Or,Ue),J(Tr,Me),J(jr,_r),jr.prototype.ta=function(){Ht(this.a,"a")},jr.prototype.sa=function(t){Ht(this.a,new Or(t))},jr.prototype.ra=function(t){Ht(this.a,new Tr(t))},jr.prototype.qa=function(){Ht(this.a,"b")},Ir.prototype.createWebChannel=Ir.prototype.a,Er.prototype.send=Er.prototype.h,Er.prototype.open=Er.prototype.g,Er.prototype.close=Er.prototype.close,Se.NO_ERROR=0,Se.TIMEOUT=8,Se.HTTP_ERROR=6,xe.COMPLETE="complete",Re.EventType=Le,Le.OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",Yt.prototype.listen=Yt.prototype.va,Bn.prototype.listenOnce=Bn.prototype.wa,Bn.prototype.getLastError=Bn.prototype.Qa,Bn.prototype.getLastErrorCode=Bn.prototype.ua,Bn.prototype.getStatus=Bn.prototype.W,Bn.prototype.getResponseJson=Bn.prototype.Pa,Bn.prototype.getResponseText=Bn.prototype.$,Bn.prototype.send=Bn.prototype.ba;var Ar=Se,Nr=xe,Dr=Ie,kr=Re,Sr=Bn,xr=u("/6Yf"),Pr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Rr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Cr=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Cr.UNAUTHENTICATED=new Cr(null),Cr.l=new Cr("google-credentials-uid"),Cr._=new Cr("first-party-uid");var Lr=new k.b("@firebase/firestore");function Ur(){return Lr.logLevel}function Mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Lr.logLevel<=k.a.DEBUG){var r=e.map(Fr);Lr.debug.apply(Lr,Object(N.h)(["Firestore (8.1.2): "+t],r))}}function Vr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Lr.logLevel<=k.a.ERROR){var r=e.map(Fr);Lr.error.apply(Lr,Object(N.h)(["Firestore (8.1.2): "+t],r))}}function qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Lr.logLevel<=k.a.WARN){var r=e.map(Fr);Lr.warn.apply(Lr,Object(N.h)(["Firestore (8.1.2): "+t],r))}}function Fr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function Br(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.2) INTERNAL ASSERTION FAILED: "+t;throw Vr(e),new Error(e)}function zr(t,e){t||Br()}function Gr(t,e){return t}var Kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Wr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(N.d)(e,t),e}(Error),Qr=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},Jr=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(Cr.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),Xr=function(){function t(t){var e=this;this.P=null,this.currentUser=Cr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then((function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.V!==e?(Mr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(zr("string"==typeof n.accessToken),new Qr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return zr(null===t||"string"==typeof t),new Cr(t)},t}(),$r=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Cr._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Yr=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new $r(this.v,this.S))},t.prototype.A=function(t){t(Cr._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();function Hr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Zr=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Hr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ti(t,e){return t<e?-1:t>e?1:0}function ei(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ni(t){return t+"\0"}var ri=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Wr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Wr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Wr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Wr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?ti(this.nanoseconds,t.nanoseconds):ti(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ii=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new ri(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),oi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Br(),void 0===n?n=t.length-e:n>t.length-e&&Br(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return this.L(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.X=function(){return new e([])},e}(oi),ui=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return ui.test(t)},e.prototype.J=function(){return this.H().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.Z(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Wr(Kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Wr(Kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Wr(Kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}(oi),ci=function(){function t(t){this.path=t}return t.st=function(e){return new t(si.Y(e))},t.it=function(e){return new t(si.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===si.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return si.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new si(e.slice()))},t}();function hi(t){return null==t}function fi(t){return 0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!fi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function di(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new pi(t,e,n,r,i,o,s)}function vi(t){var e=Gr(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.J()+t.op.toString()+co(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.J()+t.dir}(t)})).join(","),hi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=hu(e.startAt)),e.endAt&&(n+="|ub:",n+=hu(e.endAt)),e.ut=n}return e.ut}function yi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!vu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!oo(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!lu(t.startAt,e.startAt)&&lu(t.endAt,e.endAt)}function gi(t){return ci.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.at)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return ti(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();bi.lt=new bi("");var mi,wi,_i=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ii.min()),void 0===o&&(o=ii.min()),void 0===s&&(s=bi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),Ii=function(t){this.count=t};function Ei(t){switch(t){case Kr.OK:return Br();case Kr.CANCELLED:case Kr.UNKNOWN:case Kr.DEADLINE_EXCEEDED:case Kr.RESOURCE_EXHAUSTED:case Kr.INTERNAL:case Kr.UNAVAILABLE:case Kr.UNAUTHENTICATED:return!1;case Kr.INVALID_ARGUMENT:case Kr.NOT_FOUND:case Kr.ALREADY_EXISTS:case Kr.PERMISSION_DENIED:case Kr.FAILED_PRECONDITION:case Kr.ABORTED:case Kr.OUT_OF_RANGE:case Kr.UNIMPLEMENTED:case Kr.DATA_LOSS:return!0;default:return Br()}}function Oi(t){if(void 0===t)return Vr("GRPC error has no .code"),Kr.UNKNOWN;switch(t){case mi.OK:return Kr.OK;case mi.CANCELLED:return Kr.CANCELLED;case mi.UNKNOWN:return Kr.UNKNOWN;case mi.DEADLINE_EXCEEDED:return Kr.DEADLINE_EXCEEDED;case mi.RESOURCE_EXHAUSTED:return Kr.RESOURCE_EXHAUSTED;case mi.INTERNAL:return Kr.INTERNAL;case mi.UNAVAILABLE:return Kr.UNAVAILABLE;case mi.UNAUTHENTICATED:return Kr.UNAUTHENTICATED;case mi.INVALID_ARGUMENT:return Kr.INVALID_ARGUMENT;case mi.NOT_FOUND:return Kr.NOT_FOUND;case mi.ALREADY_EXISTS:return Kr.ALREADY_EXISTS;case mi.PERMISSION_DENIED:return Kr.PERMISSION_DENIED;case mi.FAILED_PRECONDITION:return Kr.FAILED_PRECONDITION;case mi.ABORTED:return Kr.ABORTED;case mi.OUT_OF_RANGE:return Kr.OUT_OF_RANGE;case mi.UNIMPLEMENTED:return Kr.UNIMPLEMENTED;case mi.DATA_LOSS:return Kr.DATA_LOSS;default:return Br()}}(wi=mi||(mi={}))[wi.OK=0]="OK",wi[wi.CANCELLED=1]="CANCELLED",wi[wi.UNKNOWN=2]="UNKNOWN",wi[wi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wi[wi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wi[wi.NOT_FOUND=5]="NOT_FOUND",wi[wi.ALREADY_EXISTS=6]="ALREADY_EXISTS",wi[wi.PERMISSION_DENIED=7]="PERMISSION_DENIED",wi[wi.UNAUTHENTICATED=16]="UNAUTHENTICATED",wi[wi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wi[wi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wi[wi.ABORTED=10]="ABORTED",wi[wi.OUT_OF_RANGE=11]="OUT_OF_RANGE",wi[wi.UNIMPLEMENTED=12]="UNIMPLEMENTED",wi[wi.INTERNAL=13]="INTERNAL",wi[wi.UNAVAILABLE=14]="UNAVAILABLE",wi[wi.DATA_LOSS=15]="DATA_LOSS";var Ti=function(){function t(t,e){this.$=t,this.root=e||Ai.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,Ai.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,Ai.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Pt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new ji(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new ji(this.root,t,this.$,!1)},t.prototype.vt=function(){return new ji(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new ji(this.root,t,this.$,!0)},t}(),ji=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),Ai=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Br();if(this.right.Mt())throw Br();var t=this.left.Qt();if(t!==this.right.Qt())throw Br();return t+(this.Mt()?0:1)},t}();Ai.EMPTY=null,Ai.RED=!0,Ai.It=!1,Ai.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Br()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new Ai(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());var Ni=function(){function t(t){this.$=t,this.data=new Ti(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt((function(e,n){return t(e),!1}))},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new Di(this.data.yt())},t.prototype.Vt=function(t){return new Di(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),Di=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),ki=new Ti(ci.$);function Si(){return ki}function xi(){return Si()}var Pi=new Ti(ci.$);function Ri(){return Pi}var Ci=new Ti(ci.$),Li=new Ni(ci.$);function Ui(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Li,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Mi=new Ni(ti);function Vi(){return Mi}var qi=function(){function t(t){this.$=t?function(e,n){return t(e,n)||ci.$(e.key,n.key)}:function(t,e){return ci.$(t.key,e.key)},this.Ht=Ri(),this.Jt=new Ti(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),Fi=function(){function t(){this.Xt=new Ti(ci.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Br():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt((function(e,n){t.push(n)})),t},t}(),Bi=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}return t.ie=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,qi.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Xs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),zi=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,Gi.he(e,n)),new t(ii.min(),r,Vi(),Si(),Ui())},t}(),Gi=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(bi.lt,n,Ui(),Ui(),Ui())},t}(),Ki=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Wi=function(t,e){this.targetId=t,this.Te=e},Qi=function(t,e,n,r){void 0===n&&(n=bi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ji=function(){function t(){this.Ie=0,this.me=Yi(),this.Ae=bi.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=Ui(),e=Ui(),n=Ui();return this.me.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Br()}})),new Gi(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=Yi()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),Xi=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=Si(),this.Me=$i(),this.ke=new Ni(ti)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof Cs?this.Le(r,t.Ee):t.Ee instanceof Ls&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Be(o[i],t.key,t.Ee)},t.prototype.qe=function(t){var e=this;this.Ue(t,(function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:Br()}}))},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach((function(t,r){n.Ke(r)&&e(r)}))},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(gi(i))if(0===n){var o=new ci(i.path);this.Be(e,o,new Ls(o,ii.min()))}else zr(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach((function(r,i){var o=e.Ge(i);if(o){if(r.le&&gi(o.target)){var s=new ci(o.target.path);null!==e.Oe.get(s)||e.Je(i,s)||e.Be(i,s,new Ls(s,t))}r.ye&&(n.set(i,r.pe()),r.ve())}}));var r=Ui();this.Me.forEach((function(t,n){var i=!0;n.Wt((function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new zi(t,n,this.ke,this.Oe,r);return this.Oe=Si(),this.Me=$i(),this.ke=new Ni(ti),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Ji,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Ni(ti),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Mr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Ji),this.xe.Xe(t).forEach((function(n){e.Be(t,n,null)}))},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();function $i(){return new Ti(ci.$)}function Yi(){return new Ti(ci.$)}function Hi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function to(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function eo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function no(t){var e=ho(t.mapValue.fields.__local_write_time__.timestampValue);return new ri(e.seconds,e.nanos)}var ro=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?eo(t)?4:10:Br()}function oo(t,e){var n=io(t);if(n!==io(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return no(t).isEqual(no(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ho(t.timestampValue),r=ho(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return lo(t.bytesValue).isEqual(lo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return fo(t.geoPointValue.latitude)===fo(e.geoPointValue.latitude)&&fo(t.geoPointValue.longitude)===fo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fo(t.integerValue)===fo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=fo(t.doubleValue),r=fo(e.doubleValue);return n===r?fi(n)===fi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ei(t.arrayValue.values||[],e.arrayValue.values||[],oo);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Hi(n)!==Hi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!oo(n[i],r[i])))return!1;return!0}(t,e);default:return Br()}}function so(t,e){return void 0!==(t.values||[]).find((function(t){return oo(t,e)}))}function uo(t,e){var n=io(t),r=io(e);if(n!==r)return ti(n,r);switch(n){case 0:return 0;case 1:return ti(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=fo(t.integerValue||t.doubleValue),r=fo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ao(t.timestampValue,e.timestampValue);case 4:return ao(no(t),no(e));case 5:return ti(t.stringValue,e.stringValue);case 6:return function(t,e){var n=lo(t),r=lo(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ti(n[i],r[i]);if(0!==o)return o}return ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ti(fo(t.latitude),fo(e.latitude));return 0!==n?n:ti(fo(t.longitude),fo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=uo(n[i],r[i]);if(o)return o}return ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ti(r[s],o[s]);if(0!==u)return u;var a=uo(n[r[s]],i[o[s]]);if(0!==a)return a}return ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Br()}}function ao(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ti(t,e);var n=ho(t),r=ho(e),i=ti(n.seconds,r.seconds);return 0!==i?i:ti(n.nanos,r.nanos)}function co(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=ho(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?lo(e.bytesValue).toBase64():"referenceValue"in e?ci.it(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Br();var n}(t)}function ho(t){if(zr(!!t),"string"==typeof t){var e=0,n=ro.exec(t);if(zr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:fo(t.seconds),nanos:fo(t.nanos)}}function fo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function lo(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function po(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function vo(t){return!!t&&"integerValue"in t}function yo(t){return!!t&&"arrayValue"in t}function go(t){return!!t&&"nullValue"in t}function bo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mo(t){return!!t&&"mapValue"in t}var wo={asc:"ASCENDING",desc:"DESCENDING"},_o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Io=function(t,e){this.t=t,this.tn=e};function Eo(t){return{integerValue:""+t}}function Oo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function To(t,e){return li(e)?Eo(e):Oo(t,e)}function jo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ao(t,e){return t.tn?e.toBase64():e.toUint8Array()}function No(t,e){return jo(t,e.M())}function Do(t){return zr(!!t),ii.N(function(t){var e=ho(t);return new ri(e.seconds,e.nanos)}(t))}function ko(t,e){return function(t){return new si(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function So(t){var e=si.Y(t);return zr(Zo(e)),e}function xo(t,e){return ko(t.t,e.path)}function Po(t,e){var n=So(e);if(n.get(1)!==t.t.projectId)throw new Wr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Wr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new ci(Uo(n))}function Ro(t,e){return ko(t.t,e)}function Co(t){var e=So(t);return 4===e.length?si.X():Uo(e)}function Lo(t){return new si(["projects",t.t.projectId,"databases",t.t.database]).J()}function Uo(t){return zr(t.length>4&&"documents"===t.get(4)),t.B(5)}function Mo(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Vo(t,e){var n;if(e instanceof Es)n={update:Mo(t,e.key,e.value)};else if(e instanceof Ds)n={delete:xo(t,e.key)};else if(e instanceof Os)n={update:Mo(t,e.key,e.data),updateMask:Ho(e.en)};else if(e instanceof js)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof is)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof os)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof us)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof cs)return{fieldPath:e.field.J(),increment:n.nn};throw Br()}(0,t)}))}};else{if(!(e instanceof ks))return Br();n={verify:xo(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:No(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Br()}(t,e.rn)),n}function qo(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?vs.updateTime(Do(t.updateTime)):void 0!==t.exists?vs.exists(t.exists):vs.on()}(e.currentDocument):vs.on();if(e.update){var r=Po(t,e.update.name),i=new Ss({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new ls((t.fieldPaths||[]).map((function(t){return ai.nt(t)})))}(e.updateMask);return new Os(r,i,o,n)}return new Es(r,i,n)}if(e.delete){var s=Po(t,e.delete);return new Ds(s,n)}if(e.transform){var u=Po(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(zr("REQUEST_TIME"===e.setToServerValue),n=new is):"appendMissingElements"in e?n=new os(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new us(e.removeAllFromArray.values||[]):"increment"in e?n=new cs(t,e.increment):Br();var r=ai.nt(e.fieldPath);return new ps(r,n)}(t,e)}));return zr(!0===n.exists),new js(u,a)}if(e.verify){var c=Po(t,e.verify);return new ks(c,n)}return Br()}function Fo(t,e){return{documents:[Ro(t,e.path)]}}function Bo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ro(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ro(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(bo(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NAN"}};if(go(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(bo(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NAN"}};if(go(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(t.field),op:Qo(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Jo(t.field),direction:Wo(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.tn||hi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Go(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Go(e.endAt)),n}function zo(t){var e=Co(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){zr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[Yo(e)]:void 0!==e.fieldFilter?[$o(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):Br():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new pu(Xo(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return hi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ko(n.startAt));var h=null;return n.endAt&&(h=Ko(n.endAt)),Vs(e,i,u,s,a,"F",c,h)}function Go(t){return{before:t.before,values:t.position}}function Ko(t){return new cu(t.values||[],!!t.before)}function Wo(t){return wo[t]}function Qo(t){return _o[t]}function Jo(t){return{fieldPath:t.J()}}function Xo(t){return ai.nt(t.fieldPath)}function $o(t){return tu.create(Xo(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Br()}}(t.fieldFilter.op),t.fieldFilter.value)}function Yo(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Xo(t.unaryFilter.field);return tu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Xo(t.unaryFilter.field);return tu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Xo(t.unaryFilter.field);return tu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Xo(t.unaryFilter.field);return tu.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Br()}}function Ho(t){var e=[];return t.fields.forEach((function(t){return e.push(t.J())})),{fieldPaths:e}}function Zo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var ts=function(){this.cn=void 0};function es(t,e,n){return t instanceof is?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof os?ss(t,e):t instanceof us?as(t,e):function(t,e){var n=rs(t,e),r=hs(n)+hs(t.nn);return vo(n)&&vo(t.nn)?Eo(r):Oo(t.serializer,r)}(t,e)}function ns(t,e,n){return t instanceof os?ss(t,e):t instanceof us?as(t,e):n}function rs(t,e){return t instanceof cs?vo(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var is=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e}(ts),os=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(N.d)(e,t),e}(ts);function ss(t,e){for(var n=fs(e),r=function(t){n.some((function(e){return oo(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var us=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(N.d)(e,t),e}(ts);function as(t,e){for(var n=fs(e),r=function(t){n=n.filter((function(e){return!oo(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return Object(N.d)(e,t),e}(ts);function hs(t){return fo(t.integerValue||t.doubleValue)}function fs(t){return yo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ls=function(){function t(t){this.fields=t,t.sort(ai.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return ei(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ps=function(t,e){this.field=t,this.transform=e},ds=function(t,e){this.version=t,this.transformResults=e},vs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ys(t,e){return void 0!==t.updateTime?e instanceof Cs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Cs}var gs=function(){};function bs(t,e,n){return t instanceof Es?function(t,e,n){return new Cs(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Os?function(t,e,n){if(!ys(t.rn,e))return new Us(t.key,n.version);var r=Ts(t,e);return new Cs(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof js?function(t,e,n){if(zr(null!=n.transformResults),!ys(t.rn,e))return new Us(t.key,n.version);var r=As(0,e),i=function(t,e,n){var r=[];zr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Cs&&(u=e.field(o.field)),r.push(ns(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ns(t,r.data(),i);return new Cs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Ls(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function ms(t,e,n,r){return t instanceof Es?function(t,e){if(!ys(t.rn,e))return e;var n=Is(e);return new Cs(t.key,n,t.value,{an:!0})}(t,e):t instanceof Os?function(t,e){if(!ys(t.rn,e))return e;var n=Is(e),r=Ts(t,e);return new Cs(t.key,n,r,{an:!0})}(t,e):t instanceof js?function(t,e,n,r){if(!ys(t.rn,e))return e;var i=As(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Cs&&(c=n.field(u.field)),null===c&&r instanceof Cs&&(c=r.field(u.field)),i.push(es(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Ns(t,i.data(),o);return new Cs(t.key,i.version,s,{an:!0})}(t,e,r,n):function(t,e){return ys(t.rn,e)?new Ls(t.key,ii.min()):e}(t,e)}function ws(t,e){return t instanceof js?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Cs?e.field(o.field):void 0,u=rs(o.transform,s||null);null!=u&&(n=null==n?(new xs).set(o.field,u):n.set(o.field,u))}return n?n.hn():null}(t,e):null}function _s(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||ei(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof os&&e instanceof os||t instanceof us&&e instanceof us?ei(t.elements,e.elements,oo):t instanceof cs&&e instanceof cs?oo(t.nn,e.nn):t instanceof is&&e instanceof is}(t.transform,e.transform)}(t,e)})))}function Is(t){return t instanceof Cs?t.version:ii.min()}var Es=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return Object(N.d)(e,t),e}(gs),Os=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return Object(N.d)(e,t),e}(gs);function Ts(t,e){return function(t,e){var n=new xs(e);return t.en.fields.forEach((function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.hn()}(t,e instanceof Cs?e.data():Ss.empty())}var js=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=vs.exists(!0),r}return Object(N.d)(e,t),e}(gs);function As(t,e){return e}function Ns(t,e,n){for(var r=new xs(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.hn()}var Ds=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return Object(N.d)(e,t),e}(gs),ks=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return Object(N.d)(e,t),e}(gs),Ss=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!mo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return oo(this.proto,t.proto)},t}(),xs=function(){function t(t){void 0===t&&(t=Ss.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===io(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(ai.X(),this._n);return null!=t?new Ss(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=mo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.dn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Ps(t){var e=[];return Zi(t.fields||{},(function(t,n){var r=new ai([t]);if(mo(n)){var i=Ps(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new ls(e)}var Rs=function(t,e){this.key=t,this.version=e},Cs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(N.d)(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Rs),Ls=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(N.d)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Rs),Us=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Rs),Ms=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null};function Vs(t,e,n,r,i,o,s,u){return new Ms(t,e,n,r,i,o,s,u)}function qs(t){return new Ms(t)}function Fs(t){return!hi(t.limit)&&"F"===t.limitType}function Bs(t){return!hi(t.limit)&&"L"===t.limitType}function zs(t){return t.Tn.length>0?t.Tn[0].field:null}function Gs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Ks(t){return null!==t.collectionGroup}function Ws(t){var e=Gr(t);if(null===e.In){e.In=[];var n=Gs(e),r=zs(e);if(null!==n&&null===r)n.tt()||e.In.push(new pu(n)),e.In.push(new pu(ai.et(),"asc"));else{for(var i=!1,o=0,s=e.Tn;o<s.length;o++){var u=s[o];e.In.push(u),u.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new pu(ai.et(),a))}}}return e.In}function Qs(t){var e=Gr(t);if(!e.mn)if("F"===e.limitType)e.mn=di(e.path,e.collectionGroup,Ws(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ws(e);r<i.length;r++){var o=i[r];n.push(new pu(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new cu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new cu(e.startAt.position,!e.startAt.before):null;e.mn=di(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.mn}function Js(t,e,n){return new Ms(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Xs(t,e){return yi(Qs(t),Qs(e))&&t.limitType===e.limitType}function $s(t){return vi(Qs(t))+"|lt:"+t.limitType}function Ys(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.J()+" "+e.op+" "+co(e.value);var e})).join(", ")+"]"),hi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+hu(t.startAt)),t.endAt&&(e+=", endAt: "+hu(t.endAt)),"Target("+e+")"}(Qs(t))+"; limitType="+t.limitType+")"}function Hs(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):ci.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!fu(t.startAt,Ws(t),e)||t.endAt&&fu(t.endAt,Ws(t),e))}(t,e)}function Zs(t){return function(e,n){for(var r=!1,i=0,o=Ws(t);i<o.length;i++){var s=o[i],u=du(s,e,n);if(0!==u)return u;r=r||s.field.tt()}return 0}}var tu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(N.d)(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new eu(t,n,r):"array-contains"===n?new ou(t,r):"in"===n?new su(t,r):"not-in"===n?new uu(t,r):"array-contains-any"===n?new au(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new nu(t,n):new ru(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(uo(e,this.value)):null!==e&&io(this.value)===io(e)&&this.Pn(uo(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Br()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),eu=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ci.it(r.referenceValue),i}return Object(N.d)(e,t),e.prototype.matches=function(t){var e=ci.$(t.key,this.key);return this.Pn(e)},e}(tu),nu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=iu(0,n),r}return Object(N.d)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tu),ru=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=iu(0,n),r}return Object(N.d)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tu);function iu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ci.it(t.referenceValue)}))}var ou=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(N.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return yo(e)&&so(e.arrayValue,this.value)},e}(tu),su=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(N.d)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&so(this.value.arrayValue,e)},e}(tu),uu=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(N.d)(e,t),e.prototype.matches=function(t){if(so(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!so(this.value.arrayValue,e)},e}(tu),au=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(N.d)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!yo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return so(e.value.arrayValue,t)}))},e}(tu),cu=function(t,e){this.position=t,this.before=e};function hu(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return co(t)})).join(",")}function fu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.tt()?ci.$(ci.it(s.referenceValue),n.key):uo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function lu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!oo(t.position[n],e.position[n]))return!1;return!0}var pu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function du(t,e,n){var r=t.field.tt()?ci.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?uo(r,i):Br()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Br()}}function vu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var yu=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=bs(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ms(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ms(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ui())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ei(this.mutations,t.mutations,(function(t,e){return _s(t,e)}))&&ei(this.baseMutations,t.baseMutations,(function(t,e){return _s(t,e)}))},t}(),gu=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){zr(e.mutations.length===r.length);for(var i=Ci,o=e.mutations,s=0;s<o.length;s++)i=i.Tt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),bu=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.Cn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Zi(this.Nn,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype.W=function(){return to(this.Nn)},t}(),mu=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t((function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)}),(function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&Br(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t((function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}}))},t.prototype.Ln=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn((function(){return e(n)})):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.qn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.qn(r)},t}(),wu=function(){function t(){this.Qn=new bu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:ii.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?mu.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),_u=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};function Iu(t){return new Io(t,!0)}function Eu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Ou="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Tu=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach((function(t){return t()}))},t}(),ju=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next((function(r){return n.hs(t,e,r)}))},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t}))},t.prototype.ls=function(t,e,n){var r=xi();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)})),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next((function(e){return n.fs(t,e)}))},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next((function(r){var i=n.ls(t,e,r),o=Si();return i.forEach((function(t,e){e||(e=new Ls(t,ii.min())),o=o.Tt(t,e)})),o}))},t.prototype.ws=function(t,e,n){return function(t){return ci.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Ks(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new ci(e)).next((function(t){var e=Ri();return t instanceof Cs&&(e=e.Tt(t.key,t)),e}))},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=Ri();return this.os.As(t,i).next((function(s){return mu.forEach(s,(function(s){var u=function(t,e){return new Ms(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Is(t,u,n).next((function(t){t.forEach((function(t,e){o=o.Tt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next((function(n){return r=n,o.rs.Rs(t,e)})).next((function(e){return o.Ps(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=ms(a,h,h,o.gn);r=f instanceof Cs?r.Tt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Hs(e,n)||(r=r.remove(t))})),r}))},t.prototype.Ps=function(t,e,n){for(var r=Ui(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Cs&&(c=c.Tt(t,e))})),c}))},t}(),Au=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=Ui(),i=Ui(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Nu=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();Nu.Ds=-1;var Du=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&Mr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,(function(){return e.$s=Date.now(),t()})),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),ku=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js(Object(S.n)())&&Vr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Mr("SimpleDb","Removing database:",t),Lu(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=Object(S.n)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n=this;return Object(N.e)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Mr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new xu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Wr(Kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new xu(t,n))},i.onupgradeneeded=function(t){Mr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.Ws.createOrUpgrade(t.target.result,i.transaction,t.oldVersion,n.version).next((function(){Mr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}}))}))},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(N.b)(this,void 0,void 0,(function(){var i,o,s,u,a;return Object(N.e)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,a,c,h;return Object(N.e)(this,(function(f){switch(f.label){case 0:++o,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,u.Xs(t)];case 2:return u.db=f.sent(),e=Ru.open(u.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),mu.reject(t)})).Ln(),a={},s.catch((function(){})),[4,e.ei];case 3:return[2,(a.value=(f.sent(),s),a)];case 4:return Mr("SimpleDb","Transaction failed with error:",(c=f.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),u.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Su=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return Lu(this.ni.delete())},t}(),xu=function(t){function e(e,n){var r=this;return(r=t.call(this,Kr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(N.d)(e,t),e}(Wr);function Pu(t){return"IndexedDbTransactionError"===t.name}var Ru=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new _u,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new xu(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=Mu(e.target.error);n.ci.reject(new xu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new xu(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Mr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Cu(e)},t}(),Cu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Mr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Mr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Lu(n)},t.prototype.add=function(t){return Mr("SimpleDb","ADD",this.store.name,t,t),Lu(this.store.add(t))},t.prototype.get=function(t){var e=this;return Lu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Mr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Mr("SimpleDb","DELETE",this.store.name,t),Lu(this.store.delete(t))},t.prototype.count=function(){return Mr("SimpleDb","COUNT",this.store.name),Lu(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.hi=function(t,e){Mr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,(function(t,e,n){return n.delete()}))},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new mu((function(n,r){e.onerror=function(t){var e=Mu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.ai=function(t,e){var n=[];return new mu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Su(i),s=e(i.primaryKey,i.value,o);if(s instanceof mu){var u=s.catch((function(t){return o.done(),mu.reject(t)}));n.push(u)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}})).next((function(){return mu.qn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Lu(t){return new mu((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Mu(t.target.error);n(e)}}))}var Uu=!1;function Mu(t){var e=ku.js(Object(S.n)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Wr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Uu||(Uu=!0,setTimeout((function(){throw r}),0)),r}}return t}function Vu(){return"undefined"!=typeof window?window:null}function qu(){return"undefined"!=typeof document?document:null}var Fu=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new _u,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch((function(t){}))}return t.Ii=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.mi=setTimeout((function(){return e.Ai()}),t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Wr(Kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri((function(){return null!==t.mi?(t.clearTimeout(),t.op().then((function(e){return t.Ti.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),Bu=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Du(this,"async_queue_retry"),this.Di=function(){var e=qu();e&&Mr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=qu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=qu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise((function(t){})):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri((function(){return e.gi.push(t),e.ki()}))},t.prototype.ki=function(){return Object(N.b)(this,void 0,void 0,(function(){var t,e=this;return Object(N.e)(this,(function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Pu(t=n.sent()))throw t;return Mr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs((function(){return e.ki()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Fi=function(t){var e=this,n=this.Pi.then((function(){return e.vi=!0,t().catch((function(t){throw e.pi=t,e.vi=!1,Vr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.vi=!1,t}))}));return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=Fu.Ii(this,t,e,n,(function(t){return r.$i(t)}));return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&Br()},t.prototype.Li=function(){},t.prototype.Bi=function(){return Object(N.b)(this,void 0,void 0,(function(){var t;return Object(N.e)(this,(function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then((function(){e.Vi.sort((function(t,e){return t.wi-e.wi}));for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()}))},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function zu(t,e){if(Vr("AsyncQueue",e+": "+t),Pu(t))return new Wr(Kr.UNAVAILABLE,e+": "+t);throw t}function Gu(t,e){var n=t[1],r=e[1],i=ti(t[0],e[0]);return 0===i?ti(n,r):i}var Ku=function(){function t(t){this.Ki=t,this.buffer=new Ni(Gu),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Gu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Wu={zi:!1,Hi:0,Ji:0,Yi:0},Qu=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Qu.nr=10,Qu.sr=1e3,Qu.ir=new Qu(41943040,Qu.nr,Qu.sr),Qu.rr=new Qu(-1,0,0);var Ju=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;Mr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,(function(){return Object(N.b)(e,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return Pu(e=n.sent())?(Mr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ic(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Xu=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Tr=function(t,e){var n=this;if(0===e)return mu.resolve(Nu.Ds);var r=new Ku(e);return this.dr.Ue(t,(function(t){return r.Gi(t.sequenceNumber)})).next((function(){return n.dr.Ir(t,(function(t){return r.Gi(t)}))})).next((function(){return r.maxValue}))},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(Mr("LruGarbageCollector","Garbage collection skipped; disabled"),mu.resolve(Wu)):this.Pr(t).next((function(r){return r<n.params.Xi?(Mr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),Wu):n.gr(t,e)}))},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,s,u,a,c=this,h=Date.now();return this.wr(t,this.params.Zi).next((function(e){return e>c.params.tr?(Mr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.tr+" from "+e),r=c.params.tr):r=e,o=Date.now(),c.Tr(t,r)})).next((function(r){return n=r,s=Date.now(),c.mr(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.Ar(t,n)})).next((function(t){return a=Date.now(),Ur()<=k.a.DEBUG&&Mr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-h)+"ms"),mu.resolve({zi:!0,Hi:r,Ji:i,Yi:t})}))},t}(),$u=function(){function t(){}return t.prototype.yr=function(t){this.Vr=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(ii.min())?this.pr(t,e):this.Vr._s(t,r).next((function(o){var s=i.vr(e,o);return(Fs(e)||Bs(e))&&i.br(e.limitType,s,r,n)?i.pr(t,e):(Ur()<=k.a.DEBUG&&Mr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ys(e)),i.Vr.ws(t,e,n).next((function(t){return s.forEach((function(e){t=t.Tt(e.key,e)})),t})))}))},t.prototype.vr=function(t,e){var n=new Ni(Zs(t));return e.forEach((function(e,r){r instanceof Cs&&Hs(t,r)&&(n=n.add(r))})),n},t.prototype.br=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.pr=function(t,e){return Ur()<=k.a.DEBUG&&Mr("QueryEngine","Using full collection scan to execute query:",Ys(e)),this.Vr.ws(t,e,ii.min())},t}();function Yu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Zu(e)),e=Hu(t.get(n),e);return Zu(e)}function Hu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Zu(t){return t+"\x01\x01"}function ta(t){var e=t.length;if(zr(e>=2),2===e)return zr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),si.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Br(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Br()}o=s+2}return new si(r)}var ea=function(t){this.Sr=t};function na(t,e){if(e.document)return function(t,e,n){var r=Po(t,e.name),i=Do(e.updateTime),o=new Ss({mapValue:{fields:e.fields}});return new Cs(r,i,o,{hasCommittedMutations:!!n})}(t.Sr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ci.ct(e.noDocument.path),r=ua(e.noDocument.readTime);return new Ls(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=ci.ct(e.unknownDocument.path),o=ua(e.unknownDocument.version);return new Us(i,o)}return Br()}function ra(t,e,n){var r=ia(n),i=e.key.path.q().H();if(e instanceof Cs){var o=function(t,e){return{name:xo(t,e.key),fields:e.En().mapValue.fields,updateTime:jo(t,e.version.M())}}(t.Sr,e);return new Ra(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof Ls){var s=e.key.path.H(),u=sa(e.version),a=e.hasCommittedMutations;return new Ra(null,new xa(s,u),null,a,r,i)}if(e instanceof Us){var c=e.key.path.H(),h=sa(e.version);return new Ra(new Pa(c,h),null,null,!0,r,i)}return Br()}function ia(t){var e=t.M();return[e.seconds,e.nanoseconds]}function oa(t){var e=new ri(t[0],t[1]);return ii.N(e)}function sa(t){var e=t.M();return new Aa(e.seconds,e.nanoseconds)}function ua(t){var e=new ri(t.seconds,t.nanoseconds);return ii.N(e)}function aa(t,e){var n=(e.baseMutations||[]).map((function(e){return qo(t.Sr,e)})),r=e.mutations.map((function(e){return qo(t.Sr,e)})),i=ri.fromMillis(e.localWriteTimeMs);return new yu(e.batchId,i,n,r)}function ca(t){var e,n,r=ua(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ua(t.lastLimboFreeSnapshotVersion):ii.min();return void 0!==t.query.documents?(zr(1===(n=t.query).documents.length),e=Qs(qs(Co(n.documents[0])))):e=function(t){return Qs(zo(t))}(t.query),new _i(e,t.targetId,0,t.lastListenSequenceNumber,r,i,bi.fromBase64String(t.resumeToken))}function ha(t,e){var n,r=sa(e.ft),i=sa(e.lastLimboFreeSnapshotVersion);n=gi(e.target)?Fo(t.Sr,e.target):Bo(t.Sr,e.target);var o=e.resumeToken.toBase64();return new La(e.targetId,vi(e.target),r,o,e.sequenceNumber,i,n)}function fa(t){var e=zo({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Js(e,e.limit,"L"):e}var la=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Dr=r,this.Cr={}}return t.Nr=function(e,n,r,i){return zr(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.Fr=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return va(t)._i({index:ka.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Or=function(t,e,n,r){var i=this,o=ya(t),s=va(t);return s.add({}).next((function(u){zr("number"==typeof u);for(var a=new yu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Vo(t.Sr,e)})),i=n.mutations.map((function(e){return Vo(t.Sr,e)}));return new ka(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Ni((function(t,e){return ti(t.J(),e.J())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Sa.key(i.userId,d.key.path,u);f=f.add(d.key.path.q()),h.push(s.put(c)),h.push(o.put(v,Sa.PLACEHOLDER))}return f.forEach((function(e){h.push(i.os.Mr(t,e))})),t.es((function(){i.Cr[u]=a.keys()})),mu.qn(h).next((function(){return a}))}))},t.prototype.kr=function(t,e){var n=this;return va(t).get(e).next((function(t){return t?(zr(t.userId===n.userId),aa(n.serializer,t)):null}))},t.prototype.$r=function(t,e){var n=this;return this.Cr[e]?mu.resolve(this.Cr[e]):this.kr(t,e).next((function(t){if(t){var r=t.keys();return n.Cr[e]=r,r}return null}))},t.prototype.Lr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return va(t)._i({index:ka.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(zr(e.batchId>=r),o=aa(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Br=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return va(t)._i({index:ka.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return va(t).ui(ka.userMutationsIndex,n).next((function(t){return t.map((function(t){return aa(e.serializer,t)}))}))},t.prototype.us=function(t,e){var n=this,r=Sa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ya(t)._i({range:i},(function(r,i,s){var u=r[0],a=r[2],c=ta(r[1]);if(u===n.userId&&e.path.isEqual(c))return va(t).get(a).next((function(t){if(!t)throw Br();zr(t.userId===n.userId),o.push(aa(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.ds=function(t,e){var n=this,r=new Ni(ti),i=[];return e.forEach((function(e){var o=Sa.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=ya(t)._i({range:s},(function(t,i,o){var s=t[0],u=t[2],a=ta(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()}));i.push(u)})),mu.qn(i).next((function(){return n.Ur(t,r)}))},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=Sa.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Ni(ti);return ya(t)._i({range:s},(function(t,e,o){var s=t[0],a=t[2],c=ta(t[1]);s===n.userId&&r.j(c)?c.length===i&&(u=u.add(a)):o.done()})).next((function(){return n.Ur(t,u)}))},t.prototype.Ur=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(va(t).get(e).next((function(t){if(null===t)throw Br();zr(t.userId===n.userId),r.push(aa(n.serializer,t))})))})),mu.qn(i).next((function(){return r}))},t.prototype.Qr=function(t,e){var n=this;return da(t.Kr,this.userId,e).next((function(r){return t.es((function(){n.Wr(e.batchId)})),mu.forEach(r,(function(e){return n.Dr.jr(t,e)}))}))},t.prototype.Wr=function(t){delete this.Cr[t]},t.prototype.Gr=function(t){var e=this;return this.Fr(t).next((function(n){if(!n)return mu.resolve();var r=IDBKeyRange.lowerBound(Sa.prefixForUser(e.userId)),i=[];return ya(t)._i({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ta(t[1]);i.push(o)}else r.done()})).next((function(){zr(0===i.length)}))}))},t.prototype.zr=function(t,e){return pa(t,this.userId,e)},t.prototype.Hr=function(t){var e=this;return ga(t).get(this.userId).next((function(t){return t||new Da(e.userId,-1,"")}))},t}();function pa(t,e,n){var r=Sa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ya(t)._i({range:o,li:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function da(t,e,n){var r=t.store(ka.store),i=t.store(Sa.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r._i({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){zr(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Sa.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return mu.qn(o).next((function(){return c}))}function va(t){return rc.Ys(t,ka.store)}function ya(t){return rc.Ys(t,Sa.store)}function ga(t){return rc.Ys(t,Da.store)}var ba=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return _a(t).put(Ia(e),n)},t.prototype.Hn=function(t,e){var n=_a(t),r=Ia(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Jr(t,r)}))},t.prototype.Jn=function(t,e){var n=this;return _a(t).get(Ia(e)).next((function(t){return n.Yr(t)}))},t.prototype.Xr=function(t,e){var n=this;return _a(t).get(Ia(e)).next((function(t){var e=n.Yr(t);return e?{zn:e,size:Ea(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=xi();return this.Zr(t,e,(function(t,e){var i=n.Yr(e);r=r.Tt(t,i)})).next((function(){return r}))},t.prototype.eo=function(t,e){var n=this,r=xi(),i=new Ti(ci.$);return this.Zr(t,e,(function(t,e){var o=n.Yr(e);o?(r=r.Tt(t,o),i=i.Tt(t,Ea(e))):(r=r.Tt(t,null),i=i.Tt(t,0))})).next((function(){return{no:r,so:i}}))},t.prototype.Zr=function(t,e,n){if(e.W())return mu.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return _a(t)._i({range:r},(function(t,e,r){for(var s=ci.ct(t);o&&ci.$(o,s)<0;)n(o,null),o=i.Ct();o&&o.isEqual(s)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()})).next((function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null}))},t.prototype.ws=function(t,e,n){var r=this,i=Ri(),o=e.path.length+1,s={};if(n.isEqual(ii.min())){var u=e.path.H();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.H(),c=ia(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ra.collectionReadTimeIndex}return _a(t)._i(s,(function(t,n,s){if(t.length===o){var u=na(r.serializer,n);e.path.j(u.key.path)?u instanceof Cs&&Hs(e,u)&&(i=i.Tt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.io=function(t){return new ma(this,!!t&&t.ro)},t.prototype.oo=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return wa(t).get(Ca.key).next((function(t){return zr(!!t),t}))},t.prototype.Jr=function(t,e){return wa(t).put(Ca.key,e)},t.prototype.Yr=function(t){if(t){var e=na(this.serializer,t);return e instanceof Ls&&e.version.isEqual(ii.min())?null:e}return null},t}(),ma=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).co=e,r.ro=n,r.uo=new bu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(N.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new Ni((function(t,e){return ti(t.J(),e.J())}));return this.Qn.forEach((function(o,s){var u=e.uo.get(o);if(s.zn){var a=ra(e.co.serializer,s.zn,e.Wn(o));i=i.add(o.path.q());var c=Ea(a);r+=c-u,n.push(e.co.jn(t,o,a))}else if(r-=u,e.ro){var h=ra(e.co.serializer,new Ls(o,ii.min()),e.Wn(o));n.push(e.co.jn(t,o,h))}else n.push(e.co.Hn(t,o))})),i.forEach((function(r){n.push(e.co.os.Mr(t,r))})),n.push(this.co.updateMetadata(t,r)),mu.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.co.Xr(t,e).next((function(t){return null===t?(n.uo.set(e,0),null):(n.uo.set(e,t.size),t.zn)}))},e.prototype.Xn=function(t,e){var n=this;return this.co.eo(t,e).next((function(t){var e=t.no;return t.so.forEach((function(t,e){n.uo.set(t,e)})),e}))},e}(wu);function wa(t){return rc.Ys(t,Ca.store)}function _a(t){return rc.Ys(t,Ra.store)}function Ia(t){return t.path.H()}function Ea(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Br();e=t.noDocument}return JSON.stringify(e).length}var Oa=function(){function t(){this.ao=new Ta}return t.prototype.Mr=function(t,e){return this.ao.add(e),mu.resolve()},t.prototype.As=function(t,e){return mu.resolve(this.ao.getEntries(e))},t}(),Ta=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Ni(si.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ni(si.$)).H()},t}(),ja=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;zr(n<r&&n>=0&&r<=11);var o=new Ru("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Na.store)}(t),function(t){t.createObjectStore(Da.store,{keyPath:Da.keyPath}),t.createObjectStore(ka.store,{keyPath:ka.keyPath,autoIncrement:!0}).createIndex(ka.userMutationsIndex,ka.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Sa.store)}(t),qa(t),function(t){t.createObjectStore(Ra.store)}(t));var s=mu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ua.store),t.deleteObjectStore(La.store),t.deleteObjectStore(Ma.store)}(t),qa(t)),s=s.next((function(){return function(t){var e=t.store(Ma.store),n=new Ma(0,0,ii.min().M(),0);return e.put(Ma.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(ka.store).ui().next((function(n){t.deleteObjectStore(ka.store),t.createObjectStore(ka.store,{keyPath:ka.keyPath,autoIncrement:!0}).createIndex(ka.userMutationsIndex,ka.userMutationsKeyPath,{unique:!0});var r=e.store(ka.store),i=n.map((function(t){return r.put(t)}));return mu.qn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Fa.store,{keyPath:Fa.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Ca.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ra.store);e.createIndex(Ra.readTimeIndex,Ra.readTimeIndexPath,{unique:!1}),e.createIndex(Ra.collectionReadTimeIndex,Ra.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Ba.store,{keyPath:Ba.keyPath})}(t),function(t){t.createObjectStore(za.store,{keyPath:za.keyPath})}(t)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ra.store)._i((function(t,n){e+=Ea(n)})).next((function(){var n=new Ca(e);return t.store(Ca.store).put(Ca.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Da.store),r=t.store(ka.store);return n.ui().next((function(n){return mu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(ka.userMutationsIndex,i).next((function(r){return mu.forEach(r,(function(r){zr(r.userId===n.userId);var i=aa(e.serializer,r);return da(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ua.store),n=t.store(Ra.store);return t.store(Ma.store).get(Ma.key).next((function(t){var r=[];return n._i((function(n,i){var o=new si(n),s=function(t){return[0,Yu(t)]}(o);r.push(e.get(s).next((function(n){return n?mu.resolve():function(n){return e.put(new Ua(0,Yu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return mu.qn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Va.store,{keyPath:Va.keyPath});var n=e.store(Va.store),r=new Ta,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:Yu(i)})}};return e.store(Ra.store)._i({li:!0},(function(t,e){var n=new si(t);return i(n.q())})).next((function(){return e.store(Sa.store)._i({li:!0},(function(t,e){var n=ta(t[1]);return i(n.q())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(La.store);return n._i((function(t,r){var i=ca(r),o=ha(e.serializer,i);return n.put(o)}))},t}(),Aa=function(t,e){this.seconds=t,this.nanoseconds=e},Na=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Na.store="owner",Na.key="owner";var Da=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Da.store="mutationQueues",Da.keyPath="userId";var ka=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ka.store="mutations",ka.keyPath="batchId",ka.userMutationsIndex="userMutationsIndex",ka.userMutationsKeyPath=["userId","batchId"];var Sa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Yu(e)]},t.key=function(t,e,n){return[t,Yu(e),n]},t}();Sa.store="documentMutations",Sa.PLACEHOLDER=new Sa;var xa=function(t,e){this.path=t,this.readTime=e},Pa=function(t,e){this.path=t,this.version=e},Ra=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ra.store="remoteDocuments",Ra.readTimeIndex="readTimeIndex",Ra.readTimeIndexPath="readTime",Ra.collectionReadTimeIndex="collectionReadTimeIndex",Ra.collectionReadTimeIndexPath=["parentPath","readTime"];var Ca=function(t){this.byteSize=t};Ca.store="remoteDocumentGlobal",Ca.key="remoteDocumentGlobalKey";var La=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};La.store="targets",La.keyPath="targetId",La.queryTargetsIndexName="queryTargetsIndex",La.queryTargetsKeyPath=["canonicalId","targetId"];var Ua=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ua.store="targetDocuments",Ua.keyPath=["targetId","path"],Ua.documentTargetsIndex="documentTargetsIndex",Ua.documentTargetsKeyPath=["path","targetId"];var Ma=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ma.key="targetGlobalKey",Ma.store="targetGlobal";var Va=function(t,e){this.collectionId=t,this.parent=e};function qa(t){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath}).createIndex(Ua.documentTargetsIndex,Ua.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(La.store,{keyPath:La.keyPath}).createIndex(La.queryTargetsIndexName,La.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ma.store)}Va.store="collectionParents",Va.keyPath=["collectionId","parent"];var Fa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Fa.store="clientMetadata",Fa.keyPath="clientId";var Ba=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ba.store="bundles",Ba.keyPath="bundleId";var za=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};za.store="namedQueries",za.keyPath="name";var Ga=Object(N.h)(Object(N.h)(Object(N.h)(Object(N.h)([Da.store,ka.store,Sa.store,Ra.store,La.store,Na.store,Ma.store,Ua.store],[Fa.store]),[Ca.store]),[Va.store]),[Ba.store,za.store]),Ka=function(){function t(t){this.serializer=t}return t.prototype.ho=function(t,e){return Wa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:ua(e.createTime),version:e.version};var e}))},t.prototype.lo=function(t,e){return Wa(t).put({bundleId:(n=e).id,createTime:sa(Do(n.createTime)),version:n.version});var n},t.prototype._o=function(t,e){return Qa(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:fa(e.bundledQuery),readTime:ua(e.readTime)};var e}))},t.prototype.fo=function(t,e){return Qa(t).put(function(t){return{name:t.name,readTime:sa(Do(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Wa(t){return rc.Ys(t,Ba.store)}function Qa(t){return rc.Ys(t,za.store)}var Ja=function(){function t(){this.wo=new Ta}return t.prototype.Mr=function(t,e){var n=this;if(!this.wo.has(e)){var r=e.K(),i=e.q();t.es((function(){n.wo.add(e)}));var o={collectionId:r,parent:Yu(i)};return Xa(t).put(o)}return mu.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ni(e),""],!1,!0);return Xa(t).ui(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ta(o.parent))}return n}))},t}();function Xa(t){return rc.Ys(t,Va.store)}var $a=function(){function t(t){this.Eo=t}return t.prototype.next=function(){return this.Eo+=2,this.Eo},t.To=function(){return new t(0)},t.Io=function(){return new t(-1)},t}(),Ya=function(){function t(t,e){this.Dr=t,this.serializer=e}return t.prototype.mo=function(t){var e=this;return this.Ao(t).next((function(n){var r=new $a(n.highestTargetId);return n.highestTargetId=r.next(),e.Ro(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Po=function(t){return this.Ao(t).next((function(t){return ii.N(new ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.yo=function(t){return this.Ao(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Vo=function(t,e,n){var r=this;return this.Ao(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ro(t,i)}))},t.prototype.po=function(t,e){var n=this;return this.vo(t,e).next((function(){return n.Ao(t).next((function(r){return r.targetCount+=1,n.bo(e,r),n.Ro(t,r)}))}))},t.prototype.So=function(t,e){return this.vo(t,e)},t.prototype.Do=function(t,e){var n=this;return this.Co(t,e.targetId).next((function(){return Ha(t).delete(e.targetId)})).next((function(){return n.Ao(t)})).next((function(e){return zr(e.targetCount>0),e.targetCount-=1,n.Ro(t,e)}))},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return Ha(t)._i((function(s,u){var a=ca(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Do(t,a)))})).next((function(){return mu.qn(o)})).next((function(){return i}))},t.prototype.Ue=function(t,e){return Ha(t)._i((function(t,n){var r=ca(n);e(r)}))},t.prototype.Ao=function(t){return Za(t).get(Ma.key).next((function(t){return zr(null!==t),t}))},t.prototype.Ro=function(t,e){return Za(t).put(Ma.key,e)},t.prototype.vo=function(t,e){return Ha(t).put(ha(this.serializer,e))},t.prototype.bo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.No=function(t){return this.Ao(t).next((function(t){return t.targetCount}))},t.prototype.xo=function(t,e){var n=vi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ha(t)._i({range:r,index:La.queryTargetsIndexName},(function(t,n,r){var o=ca(n);yi(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Fo=function(t,e,n){var r=this,i=[],o=tc(t);return e.forEach((function(e){var s=Yu(e.path);i.push(o.put(new Ua(n,s))),i.push(r.Dr.Oo(t,n,e))})),mu.qn(i)},t.prototype.Mo=function(t,e,n){var r=this,i=tc(t);return mu.forEach(e,(function(e){var o=Yu(e.path);return mu.qn([i.delete([n,o]),r.Dr.ko(t,n,e)])}))},t.prototype.Co=function(t,e){var n=tc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.$o=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=tc(t),i=Ui();return r._i({range:n,li:!0},(function(t,e,n){var r=ta(t[1]),o=new ci(r);i=i.add(o)})).next((function(){return i}))},t.prototype.zr=function(t,e){var n=Yu(e.path),r=IDBKeyRange.bound([n],[ni(n)],!1,!0),i=0;return tc(t)._i({index:Ua.documentTargetsIndex,li:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ze=function(t,e){return Ha(t).get(e).next((function(t){return t?ca(t):null}))},t}();function Ha(t){return rc.Ys(t,La.store)}function Za(t){return rc.Ys(t,Ma.store)}function tc(t){return rc.Ys(t,Ua.store)}var ec="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kr=e,r.Lo=n,r}return Object(N.d)(e,t),e}(Tu),rc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=s,this.document=u,this.Bo=c,this.qo=h,this.Uo=null,this.Qo=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ko=null,this.inForeground=!1,this.Wo=null,this.jo=null,this.Go=Number.NEGATIVE_INFINITY,this.zo=function(t){return Promise.resolve()},!t.Gs())throw new Wr(Kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Dr=new sc(this,i),this.Ho=n+"main",this.serializer=new ea(a),this.Jo=new ku(this.Ho,11,new ja(this.serializer)),this.Yo=new Ya(this.Dr,this.serializer),this.os=new Ja,this.ss=function(t,e){return new ba(t,e)}(this.serializer,this.os),this.Xo=new Ka(this.serializer),this.window&&this.window.localStorage?this.Zo=this.window.localStorage:(this.Zo=null,!1===h&&Vr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof nc)return ku.Ys(t.Kr,e);throw Br()},t.prototype.start=function(){var t=this;return this.tc().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Wr(Kr.FAILED_PRECONDITION,ec);return t.ec(),t.nc(),t.sc(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Yo.yo(e)}))})).then((function(e){t.Uo=new Nu(e,t.Bo)})).then((function(){t.Qo=!0})).catch((function(e){return t.Jo&&t.Jo.close(),Promise.reject(e)}))},t.prototype.ic=function(t){var e=this;return this.zo=function(n){return Object(N.b)(e,void 0,void 0,(function(){return Object(N.e)(this,(function(e){return this.lr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.rc=function(t){var e=this;this.Jo.ti((function(n){return Object(N.b)(e,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.oc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri((function(){return Object(N.b)(e,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return this.lr?[4,this.tc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.tc=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return oc(e).put(new Fa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.cc(e).next((function(e){e||(t.isPrimary=!1,t.Cs.Mi((function(){return t.zo(!1)})))}))})).next((function(){return t.uc(e)})).next((function(n){return t.isPrimary&&!n?t.ac(e).next((function(){return!1})):!!n&&t.hc(e).next((function(){return!0}))}))})).catch((function(e){if(Pu(e))return Mr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Mr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Cs.Mi((function(){return t.zo(e)})),t.isPrimary=e}))},t.prototype.cc=function(t){var e=this;return ic(t).get(Na.key).next((function(t){return mu.resolve(e.lc(t))}))},t.prototype._c=function(t){return oc(t).delete(this.clientId)},t.prototype.fc=function(){return Object(N.b)(this,void 0,void 0,(function(){var e,n,r,i=this;return Object(N.e)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.dc(this.Go,18e5)?[3,2]:(this.Go=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Ys(e,Fa.store);return n.ui().next((function(t){var e=i.wc(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return mu.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Zo)for(n=0,r=e;n<r.length;n++)this.Zo.removeItem(this.Ec(r[n].clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.sc=function(){var t=this;this.jo=this.Cs.Us("client_metadata_refresh",4e3,(function(){return t.tc().then((function(){return t.fc()})).then((function(){return t.sc()}))}))},t.prototype.lc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.uc=function(t){var e=this;return this.qo?mu.resolve(!0):ic(t).get(Na.key).next((function(n){if(null!==n&&e.dc(n.leaseTimestampMs,5e3)&&!e.Tc(n.ownerId)){if(e.lc(n)&&e.networkEnabled)return!0;if(!e.lc(n)){if(!n.allowTabSynchronization)throw new Wr(Kr.FAILED_PRECONDITION,ec);return!1}}return!(!e.networkEnabled||!e.inForeground)||oc(t).ui().next((function(t){return void 0===e.wc(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&Mr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Ic=function(){return Object(N.b)(this,void 0,void 0,(function(){var t=this;return Object(N.e)(this,(function(e){switch(e.label){case 0:return this.Qo=!1,this.mc(),this.jo&&(this.jo.cancel(),this.jo=null),this.Ac(),this.Rc(),[4,this.Jo.runTransaction("shutdown","readwrite",[Na.store,Fa.store],(function(e){var n=new nc(e,Nu.Ds);return t.ac(n).next((function(){return t._c(n)}))}))];case 1:return e.sent(),this.Jo.close(),this.Pc(),[2]}}))}))},t.prototype.wc=function(t,e){var n=this;return t.filter((function(t){return n.dc(t.updateTimeMs,e)&&!n.Tc(t.clientId)}))},t.prototype.gc=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return oc(e).ui().next((function(e){return t.wc(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"lr",{get:function(){return this.Qo},enumerable:!1,configurable:!0}),t.prototype.yc=function(t){return la.Nr(t,this.serializer,this.os,this.Dr)},t.prototype.Vc=function(){return this.Yo},t.prototype.vc=function(){return this.ss},t.prototype.bc=function(){return this.os},t.prototype.Sc=function(){return this.Xo},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Mr("IndexedDbPersistence","Starting transaction:",t),this.Jo.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ga,(function(o){return r=new nc(o,i.Uo?i.Uo.next():Nu.Ds),"readwrite-primary"===e?i.cc(r).next((function(t){return!!t||i.uc(r)})).next((function(e){if(!e)throw Vr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Cs.Mi((function(){return i.zo(!1)})),new Wr(Kr.FAILED_PRECONDITION,Ou);return n(r)})).next((function(t){return i.hc(r).next((function(){return t}))})):i.Dc(r).next((function(){return n(r)}))})).then((function(t){return r.ns(),t}))},t.prototype.Dc=function(t){var e=this;return ic(t).get(Na.key).next((function(t){if(null!==t&&e.dc(t.leaseTimestampMs,5e3)&&!e.Tc(t.ownerId)&&!e.lc(t)&&!(e.qo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Wr(Kr.FAILED_PRECONDITION,ec)}))},t.prototype.hc=function(t){var e=new Na(this.clientId,this.allowTabSynchronization,Date.now());return ic(t).put(Na.key,e)},t.Gs=function(){return ku.Gs()},t.prototype.ac=function(t){var e=this,n=ic(t);return n.get(Na.key).next((function(t){return e.lc(t)?(Mr("IndexedDbPersistence","Releasing primary lease."),n.delete(Na.key)):mu.resolve()}))},t.prototype.dc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Vr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.ec=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Wo=function(){t.Cs.Ri((function(){return t.inForeground="visible"===t.document.visibilityState,t.tc()}))},this.document.addEventListener("visibilitychange",this.Wo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Ac=function(){this.Wo&&(this.document.removeEventListener("visibilitychange",this.Wo),this.Wo=null)},t.prototype.nc=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ko=function(){e.mc(),e.Cs.Ri((function(){return e.Ic()}))},this.window.addEventListener("unload",this.Ko))},t.prototype.Rc=function(){this.Ko&&(this.window.removeEventListener("unload",this.Ko),this.Ko=null)},t.prototype.Tc=function(t){var e;try{var n=null!==(null===(e=this.Zo)||void 0===e?void 0:e.getItem(this.Ec(t)));return Mr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Vr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.mc=function(){if(this.Zo)try{this.Zo.setItem(this.Ec(this.clientId),String(Date.now()))}catch(t){Vr("Failed to set zombie client id.",t)}},t.prototype.Pc=function(){if(this.Zo)try{this.Zo.removeItem(this.Ec(this.clientId))}catch(t){}},t.prototype.Ec=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function ic(t){return rc.Ys(t,Na.store)}function oc(t){return rc.Ys(t,Fa.store)}var sc=function(){function t(t,e){this.db=t,this.cr=new Xu(this,e)}return t.prototype.Er=function(t){var e=this.Cc(t);return this.db.Vc().No(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Cc=function(t){var e=0;return this.Ir(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ue=function(t,e){return this.db.Vc().Ue(t,e)},t.prototype.Ir=function(t,e){return this.Nc(t,(function(t,n){return e(n)}))},t.prototype.Oo=function(t,e,n){return uc(t,n)},t.prototype.ko=function(t,e,n){return uc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Vc().mr(t,e,n)},t.prototype.jr=function(t,e){return uc(t,e)},t.prototype.xc=function(t,e){return function(t,e){var n=!1;return ga(t).fi((function(r){return pa(t,r,e).next((function(t){return t&&(n=!0),mu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.vc().io(),i=[],o=0;return this.Nc(t,(function(s,u){if(u<=e){var a=n.xc(t,s).next((function(e){if(!e)return o++,r.Jn(t,s).next((function(){return r.Hn(s),tc(t).delete([0,Yu(s.path)])}))}));i.push(a)}})).next((function(){return mu.qn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Lo);return this.db.Vc().So(t,n)},t.prototype.Fc=function(t,e){return uc(t,e)},t.prototype.Nc=function(t,e){var n,r=tc(t),i=Nu.Ds;return r._i({index:Ua.documentTargetsIndex},(function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Nu.Ds&&e(new ci(ta(n)),i),i=s,n=o):i=Nu.Ds})).next((function(){i!==Nu.Ds&&e(new ci(ta(n)),i)}))},t.prototype.Pr=function(t){return this.db.vc().oo(t)},t}();function uc(t,e){return tc(t).put(function(t,e){return new Ua(0,Yu(t.path),e)}(e,t.Lo))}function ac(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var cc=function(){function t(t,e,n,r){this.persistence=t,this.Oc=e,this.serializer=r,this.Mc=new Ti(ti),this.kc=new bu((function(t){return vi(t)}),yi),this.$c=ii.min(),this.rs=t.yc(n),this.Lc=t.vc(),this.Yo=t.Vc(),this.Bc=new ju(this.Lc,this.rs,this.persistence.bc()),this.Xo=t.Sc(),this.Oc.yr(this.Bc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Rr(n,e.Mc)}))},t}();function hc(t,e,n,r){return new cc(t,e,n,r)}function fc(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:return n=Gr(t),r=n.rs,i=n.Bc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.rs.qr(t).next((function(s){return o=s,r=n.persistence.yc(e),i=new ju(n.Lc,r,n.persistence.bc()),r.qr(t)})).next((function(e){for(var n=[],r=[],s=Ui(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=e;l<p.length;l++){var d=p[l];r.push(d.batchId);for(var v=0,y=d.mutations;v<y.length;v++)s=s.add(y[v].key)}return i._s(t,s).next((function(t){return{qc:t,Uc:n,Qc:r}}))}))}))];case 1:return o=s.sent(),[2,(n.rs=r,n.Bc=i,n.Oc.yr(n.Bc),o)]}}))}))}function lc(t,e){var n=Gr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Lc.io({ro:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=mu.resolve();return o.forEach((function(t){s=s.next((function(){return r.Jn(e,t)})).next((function(e){var o=e,s=n.Sn.get(t);zr(null!==s),(!o||o.version.F(s)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)}))})),s.next((function(){return t.rs.Qr(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.rs.Gr(t)})).next((function(){return n.Bc._s(t,r)}))}))}function pc(t){var e=Gr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Yo.Po(t)}))}function dc(t,e){var n=Gr(t),r=e.ft,i=n.Mc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Lc.io({ro:!0});i=n.Mc;var s=[];e.re.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.Yo.Mo(t,e.de,o).next((function(){return n.Yo.Fo(t,e._e,o)})));var a=e.resumeToken;if(a.ht()>0){var c=u.wt(a,r).dt(t.Lo);i=i.Tt(o,c),function(t,e,n){return zr(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(u,c,e)&&s.push(n.Yo.So(t,c))}}}));var u=Si();if(e.ce.forEach((function(r,i){e.ue.has(r)&&s.push(n.persistence.Dr.Fc(t,r))})),s.push(function(t,e,n,r,i){var o=Ui();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var i=Si();return n.forEach((function(n,o){var s=t.get(n),u=r;o instanceof Ls&&o.version.isEqual(ii.min())?(e.Hn(n,u),i=i.Tt(n,o)):null==s||o.version.F(s.version)>0||0===o.version.F(s.version)&&s.hasPendingWrites?(e.jn(o,u),i=i.Tt(n,o)):Mr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),i}))}(t,o,e.ce,r).next((function(t){u=t}))),!r.isEqual(ii.min())){var a=n.Yo.Po(t).next((function(e){return n.Yo.Vo(t,t.Lo,r)}));s.push(a)}return mu.qn(s).next((function(){return o.apply(t)})).next((function(){return n.Bc.fs(t,u)}))})).then((function(t){return n.Mc=i,t}))}function vc(t,e){var n=Gr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.rs.Lr(t,e)}))}function yc(t,e){var n=Gr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Yo.xo(t,e).next((function(i){return i?mu.resolve(r=i):n.Yo.mo(t).next((function(i){return r=new _i(e,i,0,t.Lo),n.Yo.po(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Mc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Mc=n.Mc.Tt(t.targetId,t),n.kc.set(e,t.targetId)),t}))}function gc(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:r=Gr(t),i=r.Mc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Dr.removeTarget(t,i)}))];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Pu(s=u.sent()))throw s;return Mr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Mc=r.Mc.remove(e),r.kc.delete(i.target),[2]}}))}))}function bc(t,e,n){var r=Gr(t),i=ii.min(),o=Ui();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Gr(t),i=r.kc.get(n);return void 0!==i?mu.resolve(r.Mc.get(i)):r.Yo.xo(e,n)}(r,t,Qs(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Yo.$o(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Oc.ws(t,e,n?i:ii.min(),n?o:Ui())})).next((function(t){return{documents:t,Kc:o}}))}))}function mc(t,e){var n=Gr(t),r=Gr(n.Yo),i=n.Mc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ze(t,e).next((function(t){return t?t.target:null}))}))}function wc(t){var e=Gr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Gr(t),i=Si(),o=ia(n),s=_a(e),u=IDBKeyRange.lowerBound(o,!0);return s._i({index:Ra.readTimeIndex,range:u},(function(t,e){var n=na(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime})).next((function(){return{Wc:i,readTime:oa(o)}}))}(e.Lc,t,e.$c)})).then((function(t){var n=t.Wc;return e.$c=t.readTime,n}))}function _c(t){return Object(N.b)(this,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){return[2,(e=Gr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=_a(t),n=ii.min();return e._i({index:Ra.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=oa(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$c=t}))]}))}))}function Ic(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){if(t.code!==Kr.FAILED_PRECONDITION||t.message!==Ou)throw t;return Mr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Ec=function(){function t(t,e,n,r,i,o){this.Cs=t,this.jc=n,this.Gc=r,this.zc=i,this.listener=o,this.state=0,this.Hc=0,this.Jc=null,this.stream=null,this.Si=new Du(t,e)}return t.prototype.Yc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Xc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Zc()},t.prototype.stop=function(){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return this.Yc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.tu=function(){this.state=0,this.Si.reset()},t.prototype.eu=function(){var t=this;this.Xc()&&null===this.Jc&&(this.Jc=this.Cs.Us(this.jc,6e4,(function(){return t.nu()})))},t.prototype.su=function(t){this.iu(),this.stream.send(t)},t.prototype.nu=function(){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(t){return this.Xc()?[2,this.close(0)]:[2]}))}))},t.prototype.iu=function(){this.Jc&&(this.Jc.cancel(),this.Jc=null)},t.prototype.close=function(t,e){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(n){switch(n.label){case 0:return this.iu(),this.Si.cancel(),this.Hc++,3!==t?this.Si.reset():e&&e.code===Kr.RESOURCE_EXHAUSTED?(Vr(e.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===Kr.UNAUTHENTICATED&&this.zc.m(),null!==this.stream&&(this.ru(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ou(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ru=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.cu(this.Hc),n=this.Hc;this.zc.getToken().then((function(e){t.Hc===n&&t.uu(e)}),(function(n){e((function(){var e=new Wr(Kr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.au(e)}))}))},t.prototype.uu=function(t){var e=this,n=this.cu(this.Hc);this.stream=this.hu(t),this.stream.lu((function(){n((function(){return e.state=2,e.listener.lu()}))})),this.stream.ou((function(t){n((function(){return e.au(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Zc=function(){var t=this;this.state=4,this.Si.Bs((function(){return Object(N.b)(t,void 0,void 0,(function(){return Object(N.e)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.au=function(t){return Mr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.cu=function(t){var e=this;return function(n){e.Cs.Ri((function(){return e.Hc===t?n():(Mr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Oc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return Object(N.d)(e,t),e.prototype.hu=function(t){return this.Gc._u("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Br()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(zr(void 0===e||"string"==typeof e),bi.fromBase64String(e||"")):(zr(void 0===e||e instanceof Uint8Array),bi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?Kr.UNKNOWN:Oi(t.code);return new Wr(e,t.message||"")}(s);n=new Qi(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=Po(t,a.document.name),h=Do(a.document.updateTime),f=new Ss({mapValue:{fields:a.document.fields}}),l=new Cs(c,h,f,{});n=new Ki(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=Po(t,p.document),v=p.readTime?Do(p.readTime):ii.min(),y=new Ls(d,v);n=new Ki([],p.removedTargetIds||[],y.key,y)}else if("documentRemove"in e){var g=e.documentRemove,b=Po(t,g.document);n=new Ki([],g.removedTargetIds||[],b,null)}else{if(!("filter"in e))return Br();var m=e.filter,w=new Ii(m.count||0);n=new Wi(m.targetId,w)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ii.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ii.min():e.readTime?Do(e.readTime):ii.min()}(t);return this.listener.fu(e,n)},e.prototype.du=function(t){var e={};e.database=Lo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=gi(r)?{documents:Fo(t,r)}:{query:Bo(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=Ao(t,e.resumeToken):e.ft.F(ii.min())>0&&(n.readTime=jo(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Br()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.su(e)},e.prototype.wu=function(t){var e={};e.database=Lo(this.serializer),e.removeTarget=t,this.su(e)},e}(Ec),Tc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Eu=!1,s}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"Tu",{get:function(){return this.Eu},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Eu=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ru=function(){this.Eu&&this.Iu([])},e.prototype.hu=function(t){return this.Gc._u("Write",t)},e.prototype.onMessage=function(t){if(zr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Eu){this.Si.reset();var e=function(t,e){return t&&t.length>0?(zr(void 0!==e),t.map((function(t){return function(t,e){var n=Do(t.updateTime?t.updateTime:e);n.isEqual(ii.min())&&(n=Do(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ds(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Do(t.commitTime);return this.listener.mu(n,e)}return zr(!t.writeResults||0===t.writeResults.length),this.Eu=!0,this.listener.Au()},e.prototype.Ru=function(){var t={};t.database=Lo(this.serializer),this.su(t)},e.prototype.Iu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Vo(e.serializer,t)}))};this.su(n)},e}(Ec),jc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Gc=n,i.serializer=r,i.Pu=!1,i}return Object(N.d)(e,t),e.prototype.gu=function(){if(this.Pu)throw new Wr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.yu=function(t,e,n){var r=this;return this.gu(),this.credentials.getToken().then((function(i){return r.Gc.yu(t,e,n,i)})).catch((function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.m(),t}))},e.prototype.Vu=function(t,e,n){var r=this;return this.gu(),this.credentials.getToken().then((function(i){return r.Gc.Vu(t,e,n,i)})).catch((function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.m(),t}))},e.prototype.terminate=function(){this.Pu=!1},e}((function(){})),Ac=function(){function t(t,e){this.di=t,this.pu=e,this.state="Unknown",this.vu=0,this.bu=null,this.Su=!0}return t.prototype.Du=function(){var t=this;0===this.vu&&(this.Cu("Unknown"),this.bu=this.di.Us("online_state_timeout",1e4,(function(){return t.bu=null,t.Nu("Backend didn't respond within 10 seconds."),t.Cu("Offline"),Promise.resolve()})))},t.prototype.xu=function(t){"Online"===this.state?this.Cu("Unknown"):(this.vu++,this.vu>=1&&(this.Fu(),this.Nu("Connection failed 1 times. Most recent error: "+t.toString()),this.Cu("Offline")))},t.prototype.set=function(t){this.Fu(),this.vu=0,"Online"===t&&(this.Su=!1),this.Cu(t)},t.prototype.Cu=function(t){t!==this.state&&(this.state=t,this.pu(t))},t.prototype.Nu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Su?(Vr(e),this.Su=!1):Mr("OnlineStateTracker",e)},t.prototype.Fu=function(){null!==this.bu&&(this.bu.cancel(),this.bu=null)},t}(),Nc=function(t,e,n,r,i){var o=this;this.Ou=t,this.Mu=e,this.di=n,this.ku={},this.$u=[],this.Lu=new Map,this.Bu=new Set,this.qu=[],this.Uu=i,this.Uu.Qu((function(t){n.Ri((function(){return Object(N.b)(o,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return Uc(this)?(Mr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(N.b)(this,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return(e=Gr(t)).Bu.add(4),[4,kc(e)];case 1:return n.sent(),e.Ku.set("Unknown"),e.Bu.delete(4),[4,Dc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Ku=new Ac(n,r)};function Dc(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:if(!Uc(t))return[3,4];e=0,n=t.qu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function kc(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:e=0,n=t.qu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Sc(t,e){var n=Gr(t);n.Lu.has(e.targetId)||(n.Lu.set(e.targetId,e),Lc(n)?Cc(n):Hc(n).Xc()&&Pc(n,e))}function xc(t,e){var n=Gr(t),r=Hc(n);n.Lu.delete(e),r.Xc()&&Rc(n,e),0===n.Lu.size&&(r.Xc()?r.eu():Uc(n)&&n.Ku.set("Unknown"))}function Pc(t,e){t.Wu.De(e.targetId),Hc(t).du(e)}function Rc(t,e){t.Wu.De(e),Hc(t).wu(e)}function Cc(t){t.Wu=new Xi({Xe:function(e){return t.ku.Xe(e)},Ze:function(e){return t.Lu.get(e)||null}}),Hc(t).start(),t.Ku.Du()}function Lc(t){return Uc(t)&&!Hc(t).Yc()&&t.Lu.size>0}function Uc(t){return 0===Gr(t).Bu.size}function Mc(t){t.Wu=void 0}function Vc(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){return t.Lu.forEach((function(e,n){Pc(t,e)})),[2]}))}))}function qc(t,e){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(n){return Mc(t),Lc(t)?(t.Ku.xu(e),Cc(t)):t.Ku.set("Unknown"),[2]}))}))}function Fc(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:if(t.Ku.set("Online"),!(e instanceof Qi&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.Lu.has(o=i[r])?[4,t.ku.ju(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.Lu.delete(o),t.Wu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Mr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Bc(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ki?t.Wu.$e(e):e instanceof Wi?t.Wu.je(e):t.Wu.qe(e),n.isEqual(ii.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,pc(t.Ou)];case 8:return i=s.sent(),n.F(i)>=0?[4,function(t,e){var n=t.Wu.He(e);return n.re.forEach((function(n,r){if(n.resumeToken.ht()>0){var i=t.Lu.get(r);i&&t.Lu.set(r,i.wt(n.resumeToken,e))}})),n.oe.forEach((function(e){var n=t.Lu.get(e);if(n){t.Lu.set(e,n.wt(bi.lt,n.ft)),Rc(t,e);var r=new _i(n.target,e,1,n.sequenceNumber);Pc(t,r)}})),t.ku.Gu(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Mr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Bc(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function Bc(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r=this;return Object(N.e)(this,(function(i){switch(i.label){case 0:if(!Pu(e))throw e;return t.Bu.add(1),[4,kc(t)];case 1:return i.sent(),t.Ku.set("Offline"),n||(n=function(){return pc(t.Ou)}),t.di.Mi((function(){return Object(N.b)(r,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return Mr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Bu.delete(1),[4,Dc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function zc(t,e){return e().catch((function(n){return Bc(t,n,e)}))}function Gc(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:e=Gr(t),n=Zc(e),r=e.$u.length>0?e.$u[e.$u.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Uc(t)&&t.$u.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,vc(e.Ou,r)];case 3:return null===(i=s.sent())?(0===e.$u.length&&n.eu(),[3,7]):(r=i.batchId,function(t,e){t.$u.push(e);var n=Zc(t);n.Xc()&&n.Tu&&n.Iu(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Bc(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Kc(e)&&Wc(e),[2]}}))}))}function Kc(t){return Uc(t)&&!Zc(t).Yc()&&t.$u.length>0}function Wc(t){Zc(t).start()}function Qc(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){return Zc(t).Ru(),[2]}))}))}function Jc(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n,r;return Object(N.e)(this,(function(i){for(e=Zc(t),n=0,r=t.$u;n<r.length;n++)e.Iu(r[n].mutations);return[2]}))}))}function Xc(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:return r=t.$u.shift(),i=gu.from(r,e,n),[4,zc(t,(function(){return t.ku.zu(i)}))];case 1:return o.sent(),[4,Gc(t)];case 2:return o.sent(),[2]}}))}))}function $c(t,e){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(n){switch(n.label){case 0:return e&&Zc(t).Tu?[4,function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r;return Object(N.e)(this,(function(i){switch(i.label){case 0:return Ei(r=e.code)&&r!==Kr.ABORTED?(n=t.$u.shift(),Zc(t).tu(),[4,zc(t,(function(){return t.ku.Hu(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Gc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Kc(t)&&Wc(t),[2]}}))}))}function Yc(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n;return Object(N.e)(this,(function(r){switch(r.label){case 0:return n=Gr(t),e?(n.Bu.delete(2),[4,Dc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Bu.add(2),[4,kc(n)]);case 3:r.sent(),n.Ku.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Hc(t){var e=this;return t.Ju||(t.Ju=function(t,e,n){var r=Gr(t);return r.gu(),new Oc(e,r.Gc,r.credentials,r.serializer,n)}(t.Mu,t.di,{lu:Vc.bind(null,t),ou:qc.bind(null,t),fu:Fc.bind(null,t)}),t.qu.push((function(n){return Object(N.b)(e,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return n?(t.Ju.tu(),Lc(t)?Cc(t):t.Ku.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ju.stop()];case 2:e.sent(),Mc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ju}function Zc(t){var e=this;return t.Yu||(t.Yu=function(t,e,n){var r=Gr(t);return r.gu(),new Tc(e,r.Gc,r.credentials,r.serializer,n)}(t.Mu,t.di,{lu:Qc.bind(null,t),ou:$c.bind(null,t),Au:Jc.bind(null,t),mu:Xc.bind(null,t)}),t.qu.push((function(n){return Object(N.b)(e,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return n?(t.Yu.tu(),[4,Gc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Yu.stop()];case 3:e.sent(),t.$u.length>0&&(Mr("RemoteStore","Stopping write stream with "+t.$u.length+" pending writes"),t.$u=[]),e.label=4;case 4:return[2]}}))}))}))),t.Yu}var th=function(){this.Xu=void 0,this.listeners=[]},eh=function(){this.queries=new bu((function(t){return $s(t)}),Xs),this.onlineState="Unknown",this.Zu=new Set};function nh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return Object(N.e)(this,(function(c){switch(c.label){case 0:if(n=Gr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new th),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.ta(r)];case 2:return s.Xu=c.sent(),[3,4];case 3:return u=c.sent(),a=zu(u,"Initialization of query '"+Ys(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.ea(n.onlineState),o.Xu&&e.na(o.Xu)&&sh(n),[2]}}))}))}function rh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(N.e)(this,(function(u){return n=Gr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.sa(r))]:[2]}))}))}function ih(t,e){for(var n=Gr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=n.queries.get(s.query);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].na(s)&&(r=!0);u.Xu=s}}r&&sh(n)}function oh(t,e,n){var r=Gr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function sh(t){t.Zu.forEach((function(t){t.next()}))}var uh=function(){function t(t,e,n){this.query=t,this.ia=e,this.ra=!1,this.oa=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.na=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ra?this.ca(t)&&(this.ia.next(t),o=!0):this.ua(t,this.onlineState)&&(this.aa(t),o=!0),this.oa=t,o},t.prototype.onError=function(t){this.ia.error(t)},t.prototype.ea=function(t){this.onlineState=t;var e=!1;return this.oa&&!this.ra&&this.ua(this.oa,t)&&(this.aa(this.oa),e=!0),e},t.prototype.ua=function(t,e){return!t.fromCache||!(this.options.ha&&"Offline"!==e||t.docs.W()&&"Offline"!==e)},t.prototype.ca=function(t){return t.docChanges.length>0||!!(t.ne||this.oa&&this.oa.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.aa=function(t){t=Bi.ie(t.query,t.docs,t.ee,t.fromCache),this.ra=!0,this.ia.next(t)},t}(),ah=function(){function t(){this.la=new Ni(ch._a),this.fa=new Ni(ch.da)}return t.prototype.W=function(){return this.la.W()},t.prototype.Oo=function(t,e){var n=new ch(t,e);this.la=this.la.add(n),this.fa=this.fa.add(n)},t.prototype.wa=function(t,e){var n=this;t.forEach((function(t){return n.Oo(t,e)}))},t.prototype.ko=function(t,e){this.Ea(new ch(t,e))},t.prototype.Ta=function(t,e){var n=this;t.forEach((function(t){return n.ko(t,e)}))},t.prototype.Ia=function(t){var e=this,n=new ci(new si([])),r=new ch(n,t),i=new ch(n,t+1),o=[];return this.fa.Kt([r,i],(function(t){e.Ea(t),o.push(t.key)})),o},t.prototype.ma=function(){var t=this;this.la.forEach((function(e){return t.Ea(e)}))},t.prototype.Ea=function(t){this.la=this.la.delete(t),this.fa=this.fa.delete(t)},t.prototype.Aa=function(t){var e=new ci(new si([])),n=new ch(e,t),r=new ch(e,t+1),i=Ui();return this.fa.Kt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.zr=function(t){var e=new ch(t,0),n=this.la.jt(e);return null!==n&&t.isEqual(n.key)},t}(),ch=function(){function t(t,e){this.key=t,this.Ra=e}return t._a=function(t,e){return ci.$(t.key,e.key)||ti(t.Ra,e.Ra)},t.da=function(t,e){return ti(t.Ra,e.Ra)||ci.$(t.key,e.key)},t}();function hh(t,e){return"firestore_clients_"+t+"_"+e}function fh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function lh(t,e){return"firestore_targets_"+t+"_"+e}var ph=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Pa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Wr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Vr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ga=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),dh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Pa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Wr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Vr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ga=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),vh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Pa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Vi(),s=0;i&&s<r.activeTargetIds.length;++s)i=li(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Vr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),yh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Pa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Vr("SharedClientState","Failed to parse online state: "+e),null)},t}(),gh=function(){function t(){this.activeTargetIds=Vi()}return t.prototype.ya=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Va=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ga=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),bh=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.pa=r,this.va=null,this.pu=null,this.ps=null,this.ba=this.Sa.bind(this),this.Da=new Ti(ti),this.lr=!1,this.Ca=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Na=hh(this.persistenceKey,this.pa),this.xa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Da=this.Da.Tt(this.pa,new gh),this.Fa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Oa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Ma=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ka=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.$a=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ba)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(N.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u,a,c,h=this;return Object(N.e)(this,(function(f){switch(f.label){case 0:return[4,this.va.gc()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.pa&&(i=this.getItem(hh(this.persistenceKey,r)))&&(o=vh.Pa(r,i))&&(this.Da=this.Da.Tt(o.clientId,o));for(this.La(),(s=this.storage.getItem(this.ka))&&(u=this.Ba(s))&&this.qa(u),a=0,c=this.Ca;a<c.length;a++)this.Sa(c[a]);return this.Ca=[],this.window.addEventListener("unload",(function(){return h.Ic()})),this.lr=!0,[2]}}))}))},t.prototype.Ss=function(t){this.setItem(this.xa,JSON.stringify(t))},t.prototype.Ua=function(){return this.Qa(this.Da)},t.prototype.Ka=function(t){var e=!1;return this.Da.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Wa=function(t){this.ja(t,"pending")},t.prototype.Ga=function(t,e,n){this.ja(t,e,n),this.za(t)},t.prototype.Ha=function(t){var e="not-current";if(this.Ka(t)){var n=this.storage.getItem(lh(this.persistenceKey,t));if(n){var r=dh.Pa(t,n);r&&(e=r.state)}}return this.Ja.ya(t),this.La(),e},t.prototype.Ya=function(t){this.Ja.Va(t),this.La()},t.prototype.Xa=function(t){return this.Ja.activeTargetIds.has(t)},t.prototype.Za=function(t){this.removeItem(lh(this.persistenceKey,t))},t.prototype.th=function(t,e,n){this.eh(t,e,n)},t.prototype.nh=function(t,e,n){var r=this;e.forEach((function(t){r.za(t)})),this.currentUser=t,n.forEach((function(t){r.Wa(t)}))},t.prototype.sh=function(t){this.ih(t)},t.prototype.rh=function(){this.oh()},t.prototype.Ic=function(){this.lr&&(this.window.removeEventListener("storage",this.ba),this.removeItem(this.Na),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Mr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Mr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Mr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Sa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Mr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Na)return void Vr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi((function(){return Object(N.b)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Object(N.e)(this,(function(u){if(this.lr){if(null!==n.key)if(this.Fa.test(n.key)){if(null==n.newValue)return t=this.uh(n.key),[2,this.ah(t,null)];if(e=this.hh(n.key,n.newValue))return[2,this.ah(e.clientId,e)]}else if(this.Oa.test(n.key)){if(null!==n.newValue&&(r=this.lh(n.key,n.newValue)))return[2,this._h(r)]}else if(this.Ma.test(n.key)){if(null!==n.newValue&&(i=this.fh(n.key,n.newValue)))return[2,this.dh(i)]}else if(n.key===this.ka){if(null!==n.newValue&&(o=this.Ba(n.newValue)))return[2,this.qa(o)]}else if(n.key===this.xa)(s=function(t){var e=Nu.Ds;if(null!=t)try{var n=JSON.parse(t);zr("number"==typeof n),e=n}catch(t){Vr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Nu.Ds&&this.ps(s);else if(n.key===this.$a)return[2,this.va.wh()]}else this.Ca.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Ja",{get:function(){return this.Da.get(this.pa)},enumerable:!1,configurable:!0}),t.prototype.La=function(){this.setItem(this.Na,this.Ja.ga())},t.prototype.ja=function(t,e,n){var r=new ph(this.currentUser,t,e,n),i=fh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ga())},t.prototype.za=function(t){var e=fh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ih=function(t){this.storage.setItem(this.ka,JSON.stringify({clientId:this.pa,onlineState:t}))},t.prototype.eh=function(t,e,n){var r=lh(this.persistenceKey,t),i=new dh(t,e,n);this.setItem(r,i.ga())},t.prototype.oh=function(){this.setItem(this.$a,"value-not-used")},t.prototype.uh=function(t){var e=this.Fa.exec(t);return e?e[1]:null},t.prototype.hh=function(t,e){var n=this.uh(t);return vh.Pa(n,e)},t.prototype.lh=function(t,e){var n=this.Oa.exec(t),r=Number(n[1]);return ph.Pa(new Cr(void 0!==n[2]?n[2]:null),r,e)},t.prototype.fh=function(t,e){var n=this.Ma.exec(t),r=Number(n[1]);return dh.Pa(r,e)},t.prototype.Ba=function(t){return yh.Pa(t)},t.prototype._h=function(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.va.Eh(t.batchId,t.state,t.error)]:(Mr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.dh=function(t){return this.va.Th(t.targetId,t.state,t.error)},t.prototype.ah=function(t,e){var n=this,r=e?this.Da.Tt(t,e):this.Da.remove(t),i=this.Qa(this.Da),o=this.Qa(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.va.Ih(s,u).then((function(){n.Da=r}))},t.prototype.qa=function(t){this.Da.get(t.clientId)&&this.pu(t.onlineState)},t.prototype.Qa=function(t){var e=Vi();return t.forEach((function(t,n){e=e.Gt(n.activeTargetIds)})),e},t}(),mh=function(){function t(){this.mh=new gh,this.Ah={},this.pu=null,this.ps=null}return t.prototype.Wa=function(t){},t.prototype.Ga=function(t,e,n){},t.prototype.Ha=function(t){return this.mh.ya(t),this.Ah[t]||"not-current"},t.prototype.th=function(t,e,n){this.Ah[t]=e},t.prototype.Ya=function(t){this.mh.Va(t)},t.prototype.Xa=function(t){return this.mh.activeTargetIds.has(t)},t.prototype.Za=function(t){delete this.Ah[t]},t.prototype.Ua=function(){return this.mh.activeTargetIds},t.prototype.Ka=function(t){return this.mh.activeTargetIds.has(t)},t.prototype.start=function(){return this.mh=new gh,Promise.resolve()},t.prototype.nh=function(t,e,n){},t.prototype.sh=function(t){},t.prototype.Ic=function(){},t.prototype.Ss=function(t){},t.prototype.rh=function(){},t}(),wh=function(t){this.key=t},_h=function(t){this.key=t},Ih=function(){function t(t,e){this.query=t,this.Rh=e,this.Ph=null,this.le=!1,this.gh=Ui(),this.ee=Ui(),this.yh=Zs(t),this.Vh=new qi(this.yh)}return Object.defineProperty(t.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),t.prototype.bh=function(t,e){var n=this,r=e?e.Sh:new Fi,i=e?e.Vh:this.Vh,o=e?e.ee:this.ee,s=i,u=!1,a=Fs(this.query)&&i.size===this.query.limit?i.last():null,c=Bs(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt((function(t,e){var h=i.get(t),f=e instanceof Cs?e:null;f&&(f=Hs(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Dh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.yh(f,a)>0||c&&n.yh(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Fs(this.query)||Bs(this.query))for(;s.size>this.query.limit;){var h=Fs(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Vh:s,Sh:r,br:u,ee:o}},t.prototype.Dh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Vh;this.Vh=t.Vh,this.ee=t.ee;var o=t.Sh.Zt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Br()}};return n(t)-n(e)}(t.type,e.type)||r.yh(t.doc,e.doc)})),this.Ch(n);var s=e?this.Nh():[],u=0===this.gh.size&&this.le?1:0,a=u!==this.Ph;return this.Ph=u,0!==o.length||a?{snapshot:new Bi(this.query,t.Vh,i,o,t.ee,0===u,a,!1),xh:s}:{xh:s}},t.prototype.ea=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Vh:this.Vh,Sh:new Fi,ee:this.ee,br:!1},!1)):{xh:[]}},t.prototype.Fh=function(t){return!this.Rh.has(t)&&!!this.Vh.has(t)&&!this.Vh.get(t).an},t.prototype.Ch=function(t){var e=this;t&&(t._e.forEach((function(t){return e.Rh=e.Rh.add(t)})),t.fe.forEach((function(t){})),t.de.forEach((function(t){return e.Rh=e.Rh.delete(t)})),this.le=t.le)},t.prototype.Nh=function(){var t=this;if(!this.le)return[];var e=this.gh;this.gh=Ui(),this.Vh.forEach((function(e){t.Fh(e.key)&&(t.gh=t.gh.add(e.key))}));var n=[];return e.forEach((function(e){t.gh.has(e)||n.push(new _h(e))})),this.gh.forEach((function(t){e.has(t)||n.push(new wh(t))})),n},t.prototype.Oh=function(t){this.Rh=t.Kc,this.gh=Ui();var e=this.bh(t.documents);return this.Zn(e,!0)},t.prototype.Mh=function(){return Bi.ie(this.query,this.Vh,this.ee,0===this.Ph)},t}(),Eh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Oh=function(t){this.key=t,this.kh=!1},Th=function(){function t(t,e,n,r,i,o){this.Ou=t,this.$h=e,this.Lh=n,this.Bh=r,this.currentUser=i,this.qh=o,this.Uh={},this.Qh=new bu((function(t){return $s(t)}),Xs),this.Kh=new Map,this.Wh=[],this.jh=new Ti(ci.$),this.Gh=new Map,this.zh=new ah,this.Hh={},this.Jh=new Map,this.Yh=$a.Io(),this.onlineState="Unknown",this.Xh=void 0}return Object.defineProperty(t.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),t}();function jh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:return n=ef(t),(i=n.Qh.get(e))?(n.Bh.Ha(i.targetId),r=i.view.Mh(),[3,4]):[3,1];case 1:return[4,yc(n.Ou,Qs(e))];case 2:return o=u.sent(),s=n.Bh.Ha(o.targetId),[4,Ah(n,e,o.targetId,"current"===s)];case 3:r=u.sent(),n.Zh&&Sc(n.$h,o),u.label=4;case 4:return[2,r]}}))}))}function Ah(t,e,n,r){return Object(N.b)(this,void 0,void 0,(function(){var i,o,s,u,a,c;return Object(N.e)(this,(function(h){switch(h.label){case 0:return t.tl=function(e,n,r){return function(t,e,n,r){return Object(N.b)(this,void 0,void 0,(function(){var i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:return(i=e.view.bh(n)).br?[4,bc(t.Ou,e.query,!1).then((function(t){return e.view.bh(t.documents,i)}))]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.re.get(e.targetId),s=e.view.Zn(i,t.Zh,o),[2,(qh(t,e.targetId,s.xh),s.snapshot)]}}))}))}(t,e,n,r)},[4,bc(t.Ou,e,!0)];case 1:return i=h.sent(),o=new Ih(e,i.Kc),s=o.bh(i.documents),u=Gi.he(n,r&&"Offline"!==t.onlineState),a=o.Zn(s,t.Zh,u),qh(t,n,a.xh),c=new Eh(e,n,o),[2,(t.Qh.set(e,c),t.Kh.has(n)?t.Kh.get(n).push(e):t.Kh.set(n,[e]),a.snapshot)]}}))}))}function Nh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:return n=Gr(t),r=n.Qh.get(e),(i=n.Kh.get(r.targetId)).length>1?[2,(n.Kh.set(r.targetId,i.filter((function(t){return!Xs(t,e)}))),void n.Qh.delete(e))]:n.Zh?(n.Bh.Ya(r.targetId),n.Bh.Ka(r.targetId)?[3,2]:[4,gc(n.Ou,r.targetId,!1).then((function(){n.Bh.Za(r.targetId),xc(n.$h,r.targetId),Mh(n,r.targetId)})).catch(Ic)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Mh(n,r.targetId),[4,gc(n.Ou,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Dh(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:r=nf(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Gr(t),i=ri.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Ui());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Bc._s(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=ws(c,n.get(c.key));null!=h&&s.push(new Os(c.key,h,Ps(h.proto.mapValue),vs.exists(!0)))}return r.rs.Or(t,i,s,e)}))})).then((function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}}))}(r.Ou,e)];case 2:return i=u.sent(),r.Bh.Wa(i.batchId),function(t,e,n){var r=t.Hh[t.currentUser.h()];r||(r=new Ti(ti)),r=r.Tt(e,n),t.Hh[t.currentUser.h()]=r}(r,i.batchId,n),[4,zh(r,i.Qn)];case 3:return u.sent(),[4,Gc(r.$h)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=zu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function kh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r;return Object(N.e)(this,(function(i){switch(i.label){case 0:n=Gr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,dc(n.Ou,e)];case 2:return r=i.sent(),e.re.forEach((function(t,e){var r=n.Gh.get(e);r&&(zr(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.kh=!0:t.fe.size>0?zr(r.kh):t.de.size>0&&(zr(r.kh),r.kh=!1))})),[4,zh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ic(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Sh(t,e,n){var r=Gr(t);if(r.Zh&&0===n||!r.Zh&&1===n){var i=[];r.Qh.forEach((function(t,n){var r=n.view.ea(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Gr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].ea(e)&&(r=!0)})),r&&sh(n)}(r.Lh,e),i.length&&r.Uh.fu(i),r.onlineState=e,r.Zh&&r.Bh.sh(e)}}function xh(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return Object(N.e)(this,(function(c){switch(c.label){case 0:return(r=Gr(t)).Bh.th(e,"rejected",n),i=r.Gh.get(e),(o=i&&i.key)?(s=(s=new Ti(ci.$)).Tt(o,new Ls(o,ii.min())),u=Ui().add(o),a=new zi(ii.min(),new Map,new Ni(ti),s,u),[4,kh(r,a)]):[3,2];case 1:return c.sent(),r.jh=r.jh.remove(o),r.Gh.delete(e),Bh(r),[3,4];case 2:return[4,gc(r.Ou,e,!1).then((function(){return Mh(r,e,n)})).catch(Ic)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Ph(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:n=Gr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,lc(n.Ou,e)];case 2:return i=o.sent(),Uh(n,r,null),Lh(n,r),n.Bh.Ga(r,"acknowledged"),[4,zh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ic(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Rh(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:r=Gr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Gr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.rs.kr(t,e).next((function(e){return zr(null!==e),r=e.keys(),n.rs.Qr(t,e)})).next((function(){return n.rs.Gr(t)})).next((function(){return n.Bc._s(t,r)}))}))}(r.Ou,e)];case 2:return i=o.sent(),Uh(r,e,n),Lh(r,e),r.Bh.Ga(e,"rejected",n),[4,zh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ic(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ch(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:Uc((n=Gr(t)).$h)||Mr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Gr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.rs.Br(t)}))}(n.Ou)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.Jh.get(r)||[]).push(e),n.Jh.set(r,i),[3,4]);case 3:return o=u.sent(),s=zu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Lh(t,e){(t.Jh.get(e)||[]).forEach((function(t){t.resolve()})),t.Jh.delete(e)}function Uh(t,e,n){var r=Gr(t),i=r.Hh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Hh[r.currentUser.h()]=i}}function Mh(t,e,n){void 0===n&&(n=null),t.Bh.Ya(e);for(var r=0,i=t.Kh.get(e);r<i.length;r++){var o=i[r];t.Qh.delete(o),n&&t.Uh.el(o,n)}t.Kh.delete(e),t.Zh&&t.zh.Ia(e).forEach((function(e){t.zh.zr(e)||Vh(t,e)}))}function Vh(t,e){var n=t.jh.get(e);null!==n&&(xc(t.$h,n),t.jh=t.jh.remove(e),t.Gh.delete(n),Bh(t))}function qh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof wh?(t.zh.Oo(o.key,e),Fh(t,o)):o instanceof _h?(Mr("SyncEngine","Document no longer in limbo: "+o.key),t.zh.ko(o.key,e),t.zh.zr(o.key)||Vh(t,o.key)):Br()}}function Fh(t,e){var n=e.key;t.jh.get(n)||(Mr("SyncEngine","New document in limbo: "+n),t.Wh.push(n),Bh(t))}function Bh(t){for(;t.Wh.length>0&&t.jh.size<t.qh;){var e=t.Wh.shift(),n=t.Yh.next();t.Gh.set(n,new Oh(e)),t.jh=t.jh.Tt(e,n),Sc(t.$h,new _i(Qs(qs(e.path)),n,2,Nu.Ds))}}function zh(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:return r=Gr(t),i=[],o=[],s=[],r.Qh.W()?[3,3]:(r.Qh.forEach((function(t,u){s.push(r.tl(u,e,n).then((function(t){if(t){r.Zh&&r.Bh.th(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Au.Vs(u.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return u.sent(),r.Uh.fu(i),[4,function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c;return Object(N.e)(this,(function(h){switch(h.label){case 0:n=Gr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return mu.forEach(e,(function(e){return mu.forEach(e.gs,(function(r){return n.persistence.Dr.Oo(t,e.targetId,r)})).next((function(){return mu.forEach(e.ys,(function(r){return n.persistence.Dr.ko(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!Pu(r=h.sent()))throw r;return Mr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=(s=o[i]).targetId,s.fromCache||(a=n.Mc.get(u),c=a.Et(a.ft),n.Mc=n.Mc.Tt(u,c));return[2]}}))}))}(r.Ou,o)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Gh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r;return Object(N.e)(this,(function(i){switch(i.label){case 0:return(n=Gr(t)).currentUser.isEqual(e)?[3,3]:(Mr("SyncEngine","User change. New user:",e.h()),[4,fc(n.Ou,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Jh.forEach((function(t){t.forEach((function(t){t.reject(new Wr(Kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Jh.clear()}(n),n.Bh.nh(e,r.Uc,r.Qc),[4,zh(n,r.qc)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Kh(t,e){var n=Gr(t),r=n.Gh.get(e);if(r&&r.kh)return Ui().add(r.key);var i=Ui(),o=n.Kh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=n.Qh.get(u[s]);i=i.Gt(a.view.ph)}return i}function Wh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:return[4,bc((n=Gr(t)).Ou,e.query,!0)];case 1:return r=o.sent(),i=e.view.Oh(r),[2,(n.Zh&&qh(n,e.targetId,i.xh),i)]}}))}))}function Qh(t){return Object(N.b)(this,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){return[2,wc((e=Gr(t)).Ou).then((function(t){return zh(e,t)}))]}))}))}function Jh(t,e,n,r){return Object(N.b)(this,void 0,void 0,(function(){var i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Gr(t),r=Gr(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.$r(t,e).next((function(e){return e?n.Bc._s(t,e):mu.resolve(null)}))}))}((i=Gr(t)).Ou,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Gc(i.$h)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Uh(i,e,r||null),Lh(i,e),function(t,e){Gr(Gr(t).rs).Wr(e)}(i.Ou,e)):Br(),s.label=4;case 4:return[4,zh(i,o)];case 5:return s.sent(),[3,7];case 6:Mr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Xh(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a;return Object(N.e)(this,(function(c){switch(c.label){case 0:return ef(n=Gr(t)),nf(n),!0!==e||!0===n.Xh?[3,3]:(r=n.Bh.Ua(),[4,$h(n,r.H())]);case 1:return i=c.sent(),n.Xh=!0,[4,Yc(n.$h,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Sc(n.$h,s[o]);return[3,7];case 3:return!1!==e||!1===n.Xh?[3,7]:(u=[],a=Promise.resolve(),n.Kh.forEach((function(t,e){n.Bh.Xa(e)?u.push(e):a=a.then((function(){return Mh(n,e),gc(n.Ou,e,!0)})),xc(n.$h,e)})),[4,a]);case 4:return c.sent(),[4,$h(n,u)];case 5:return c.sent(),function(t){var e=Gr(t);e.Gh.forEach((function(t,n){xc(e.$h,n)})),e.zh.ma(),e.Gh=new Map,e.jh=new Ti(ci.$)}(n),n.Xh=!1,[4,Yc(n.$h,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function $h(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s,u,a,c,h,f,l,p,d;return Object(N.e)(this,(function(v){switch(v.label){case 0:n=Gr(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=void 0,(c=n.Kh.get(u=s[o]))&&0!==c.length?[4,yc(n.Ou,Qs(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(l=n.Qh.get(f[h]),[4,Wh(n,l)]):[3,6];case 4:(p=v.sent()).snapshot&&i.push(p.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,mc(n.Ou,u)];case 8:return d=v.sent(),[4,yc(n.Ou,d)];case 9:return a=v.sent(),[4,Ah(n,Yh(d),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Uh.fu(i),r)]}}))}))}function Yh(t){return Vs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Hh(t){var e=Gr(t);return Gr(Gr(e.Ou).persistence).gc()}function Zh(t,e,n,r){return Object(N.b)(this,void 0,void 0,(function(){var i,o,s;return Object(N.e)(this,(function(u){switch(u.label){case 0:return(i=Gr(t)).Xh?(Mr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Kh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,wc(i.Ou)];case 3:return o=u.sent(),s=zi.ae(e,"current"===n),[4,zh(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,gc(i.Ou,e,!0)];case 6:return u.sent(),Mh(i,e,r),[3,8];case 7:Br(),u.label=8;case 8:return[2]}}))}))}function tf(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s,u,a,c,h,f;return Object(N.e)(this,(function(l){switch(l.label){case 0:if(!(r=ef(t)).Xh)return[3,10];i=0,o=e,l.label=1;case 1:return i<o.length?r.Kh.has(s=o[i])?(Mr("SyncEngine","Adding an already active target "+s),[3,5]):[4,mc(r.Ou,s)]:[3,6];case 2:return u=l.sent(),[4,yc(r.Ou,u)];case 3:return a=l.sent(),[4,Ah(r,Yh(u),a.targetId,!1)];case 4:l.sent(),Sc(r.$h,a),l.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(N.e)(this,(function(e){switch(e.label){case 0:return r.Kh.has(t)?[4,gc(r.Ou,t,!1).then((function(){xc(r.$h,t),Mh(r,t)})).catch(Ic)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,l.label=7;case 7:return h<f.length?[5,c(f[h])]:[3,10];case 8:l.sent(),l.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function ef(t){var e=Gr(t);return e.$h.ku.Gu=kh.bind(null,e),e.$h.ku.Xe=Kh.bind(null,e),e.$h.ku.ju=xh.bind(null,e),e.Uh.fu=ih.bind(null,e.Lh),e.Uh.el=oh.bind(null,e.Lh),e}function nf(t){var e=Gr(t);return e.$h.ku.zu=Ph.bind(null,e),e.$h.ku.Hu=Rh.bind(null,e),e}var rf=function(){function t(t,e){this.os=t,this.Dr=e,this.rs=[],this.nl=1,this.sl=new Ni(ch._a)}return t.prototype.Fr=function(t){return mu.resolve(0===this.rs.length)},t.prototype.Or=function(t,e,n,r){var i=this.nl;this.nl++;var o=new yu(i,e,n,r);this.rs.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new ch(a.key,i)),this.os.Mr(t,a.key.path.q())}return mu.resolve(o)},t.prototype.kr=function(t,e){return mu.resolve(this.il(e))},t.prototype.Lr=function(t,e){var n=this.rl(e+1),r=n<0?0:n;return mu.resolve(this.rs.length>r?this.rs[r]:null)},t.prototype.Br=function(){return mu.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.qr=function(t){return mu.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new ch(e,0),i=new ch(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],(function(t){var e=n.il(t.Ra);o.push(e)})),mu.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new Ni(ti);return e.forEach((function(t){var e=new ch(t,0),i=new ch(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],(function(t){r=r.add(t.Ra)}))})),mu.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;ci.ot(i)||(i=i.child(""));var o=new ch(new ci(i),0),s=new Ni(ti);return this.sl.Wt((function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(s=s.add(t.Ra)),!0)}),o),mu.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.il(t);null!==r&&n.push(r)})),n},t.prototype.Qr=function(t,e){var n=this;zr(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return mu.forEach(e.mutations,(function(i){var o=new ch(i.key,e.batchId);return r=r.delete(o),n.Dr.jr(t,i.key)})).next((function(){n.sl=r}))},t.prototype.Wr=function(t){},t.prototype.zr=function(t,e){var n=new ch(e,0),r=this.sl.jt(n);return mu.resolve(e.isEqual(r&&r.key))},t.prototype.Gr=function(t){return mu.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),of=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new Ti(ci.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:s,readTime:n}),this.size+=s-o,this.os.Mr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return mu.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=xi();return e.forEach((function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)})),mu.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=Ri(),i=new ci(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.value,a=u.zn,c=u.readTime;if(!e.path.j(s.key.path))break;c.F(n)<=0||a instanceof Cs&&Hs(e,a)&&(r=r.Tt(a.key,a))}return mu.resolve(r)},t.prototype.al=function(t,e){return mu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.io=function(t){return new sf(this)},t.prototype.oo=function(t){return mu.resolve(this.size)},t}(),sf=function(t){function e(e){var n=this;return(n=t.call(this)||this).co=e,n}return Object(N.d)(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach((function(r,i){i&&i.zn?n.push(e.co.jn(t,i.zn,e.Wn(r))):e.co.Hn(r)})),mu.qn(n)},e.prototype.Yn=function(t,e){return this.co.Jn(t,e)},e.prototype.Xn=function(t,e){return this.co.getEntries(t,e)},e}(wu),uf=function(){function t(t){this.persistence=t,this.hl=new bu((function(t){return vi(t)}),yi),this.lastRemoteSnapshotVersion=ii.min(),this.highestTargetId=0,this.ll=0,this._l=new ah,this.targetCount=0,this.fl=$a.To()}return t.prototype.Ue=function(t,e){return this.hl.forEach((function(t,n){return e(n)})),mu.resolve()},t.prototype.Po=function(t){return mu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.yo=function(t){return mu.resolve(this.ll)},t.prototype.mo=function(t){return this.highestTargetId=this.fl.next(),mu.resolve(this.highestTargetId)},t.prototype.Vo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),mu.resolve()},t.prototype.vo=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new $a(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.po=function(t,e){return this.vo(e),this.targetCount+=1,mu.resolve()},t.prototype.So=function(t,e){return this.vo(e),mu.resolve()},t.prototype.Do=function(t,e){return this.hl.delete(e.target),this._l.Ia(e.targetId),this.targetCount-=1,mu.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.Co(t,u.targetId)),i++)})),mu.qn(o).next((function(){return i}))},t.prototype.No=function(t){return mu.resolve(this.targetCount)},t.prototype.xo=function(t,e){var n=this.hl.get(e)||null;return mu.resolve(n)},t.prototype.Fo=function(t,e,n){return this._l.wa(e,n),mu.resolve()},t.prototype.Mo=function(t,e,n){this._l.Ta(e,n);var r=this.persistence.Dr,i=[];return r&&e.forEach((function(e){i.push(r.jr(t,e))})),mu.qn(i)},t.prototype.Co=function(t,e){return this._l.Ia(e),mu.resolve()},t.prototype.$o=function(t,e){var n=this._l.Aa(e);return mu.resolve(n)},t.prototype.zr=function(t,e){return mu.resolve(this._l.zr(e))},t}(),af=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ho=function(t,e){return mu.resolve(this.dl.get(e))},t.prototype.lo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:Do(n.createTime)}),mu.resolve()},t.prototype._o=function(t,e){return mu.resolve(this.wl.get(e))},t.prototype.fo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:fa(n.bundledQuery),readTime:Do(n.readTime)}),mu.resolve()},t}(),cf=function(){function t(t,e){var n=this;this.El={},this.Uo=new Nu(0),this.Qo=!1,this.Qo=!0,this.Dr=t(this),this.Yo=new uf(this),this.os=new Oa,this.ss=function(t,e){return new of(t,(function(t){return n.Dr.Tl(t)}))}(this.os),this.serializer=new ea(e),this.Xo=new af(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Ic=function(){return this.Qo=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.Qo},enumerable:!1,configurable:!0}),t.prototype.rc=function(){},t.prototype.oc=function(){},t.prototype.bc=function(){return this.os},t.prototype.yc=function(t){var e=this.El[t.h()];return e||(e=new rf(this.os,this.Dr),this.El[t.h()]=e),e},t.prototype.Vc=function(){return this.Yo},t.prototype.vc=function(){return this.ss},t.prototype.Sc=function(){return this.Xo},t.prototype.runTransaction=function(t,e,n){var r=this;Mr("MemoryPersistence","Starting transaction:",t);var i=new hf(this.Uo.next());return this.Dr.Il(),n(i).next((function(t){return r.Dr.ml(i).next((function(){return t}))})).Ln().then((function(t){return i.ns(),t}))},t.prototype.Al=function(t,e){return mu.Un(Object.values(this.El).map((function(n){return function(){return n.zr(t,e)}})))},t}(),hf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Lo=e,n}return Object(N.d)(e,t),e}(Tu),ff=function(){function t(t){this.persistence=t,this.Rl=new ah,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Br()},enumerable:!1,configurable:!0}),t.prototype.Oo=function(t,e,n){return this.Rl.Oo(n,e),this.yl.delete(n.toString()),mu.resolve()},t.prototype.ko=function(t,e,n){return this.Rl.ko(n,e),this.yl.add(n.toString()),mu.resolve()},t.prototype.jr=function(t,e){return this.yl.add(e.toString()),mu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.Ia(e.targetId).forEach((function(t){return n.yl.add(t.toString())}));var r=this.persistence.Vc();return r.$o(t,e.targetId).next((function(t){t.forEach((function(t){return n.yl.add(t.toString())}))})).next((function(){return r.Do(t,e)}))},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.vc().io();return mu.forEach(this.yl,(function(r){var i=ci.st(r);return e.Vl(t,i).next((function(t){t||n.Hn(i)}))})).next((function(){return e.Pl=null,n.apply(t)}))},t.prototype.Fc=function(t,e){var n=this;return this.Vl(t,e).next((function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())}))},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return mu.Un([function(){return mu.resolve(n.Rl.zr(e))},function(){return n.persistence.Vc().zr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),lf=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.lu=function(t){this.bl=t},t.prototype.ou=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),pf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},df=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(N.d)(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise((function(i,o){var s=new Sr;s.listenOnce(Nr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Ar.NO_ERROR:var e=s.getResponseJson();Mr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ar.TIMEOUT:Mr("Connection",'RPC "'+t+'" timed out'),o(new Wr(Kr.DEADLINE_EXCEEDED,"Request time out"));break;case Ar.HTTP_ERROR:var n=s.getStatus();if(Mr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Kr).indexOf(e)>=0?e:Kr.UNKNOWN}(r.status);o(new Wr(u,r.message))}else o(new Wr(Kr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Wr(Kr.UNAVAILABLE,"Connection failed."));break;default:Br()}}finally{Mr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype._u=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Ir,i=Oe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(o.initMessageHeaders,e),Object(S.u)()||Object(S.x)()||Object(S.r)()||Object(S.t)()||Object(S.y)()||Object(S.q)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Mr("Connection","Creating WebChannel: "+s,o);var u=r.createWebChannel(s,o),a=!1,c=!1,h=new lf({pl:function(t){c?Mr("Connection","Not sending because WebChannel is closed:",t):(a||(Mr("Connection","Opening WebChannel transport."),u.open(),a=!0),Mr("Connection","WebChannel sending:",t),u.send(t))},vl:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,kr.EventType.OPEN,(function(){c||Mr("Connection","WebChannel transport opened.")})),f(u,kr.EventType.CLOSE,(function(){c||(c=!0,Mr("Connection","WebChannel transport closed"),h.Nl())})),f(u,kr.EventType.ERROR,(function(t){c||(c=!0,qr("Connection","WebChannel transport errored:",t),h.Nl(new Wr(Kr.UNAVAILABLE,"The operation could not be completed")))})),f(u,kr.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];zr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Mr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=mi[t];if(void 0!==e)return Oi(e)}(i),s=r.message;void 0===o&&(o=Kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Nl(new Wr(o,s)),u.close()}else Mr("Connection","WebChannel received:",n),h.xl(n)}})),f(i,Dr.STAT_EVENT,(function(t){10===t.stat?Mr("Connection","Detected buffering proxy"):11===t.stat&&Mr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Cl()}),0),h},e}(function(){function t(t){this.Fl=t,this.t=t.t,this.Ol=(t.ssl?"https":"http")+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.yu=function(t,e,n,r){var i=this.kl(t,e);Mr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then((function(t){return Mr("RestConnection","Received: ",t),t}),(function(e){throw qr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Vu=function(t,e,n,r){return this.yu(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.2",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){return this.Ol+"/v1/"+e+":"+pf[t]},t}()),vf=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Qu=function(t){this.Kl.push(t)},t.prototype.Ic=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){Mr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){Mr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),yf=function(){function t(){}return t.prototype.Qu=function(t){},t.prototype.Ic=function(){},t}(),gf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return this.serializer=Iu(t.Fl.t),this.Bh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Ou=this.Jl(t),[2]}}))}))},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return hc(this.persistence,new $u,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new cf(ff.gl,this.serializer)},t.prototype.jl=function(t){return new mh},t.prototype.terminate=function(){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.Bh.Ic()];case 1:return t.sent(),[4,this.persistence.Ic()];case 2:return t.sent(),[2]}}))}))},t}(),bf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(N.d)(e,t),e.prototype.initialize=function(e){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,_c(this.Ou)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,nf(this.Xl.va)];case 4:return n.sent(),[4,Gc(this.Xl.$h)];case 5:return n.sent(),[2]}}))}))},e.prototype.Jl=function(t){return hc(this.persistence,new $u,t.Yl,this.serializer)},e.prototype.Hl=function(t){return new Ju(this.persistence.Dr.cr,t.di)},e.prototype.Gl=function(t){var e=ac(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Qu.er(this.cacheSizeBytes):Qu.ir;return new rc(this.synchronizeTabs,e,t.clientId,n,t.di,Vu(),qu(),this.serializer,this.Bh,!!this.forceOwnership)},e.prototype.jl=function(t){return new mh},e}(gf),mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(N.d)(e,t),e.prototype.initialize=function(e){return Object(N.b)(this,void 0,void 0,(function(){var n,r=this;return Object(N.e)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.va,this.Bh instanceof bh?(this.Bh.va={Eh:Jh.bind(null,n),Th:Zh.bind(null,n),Ih:tf.bind(null,n),gc:Hh.bind(null,n),wh:Qh.bind(null,n)},[4,this.Bh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.ic((function(t){return Object(N.b)(r,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return[4,Xh(this.Xl.va,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Ou):t||this.zl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.jl=function(t){var e=Vu();if(!bh.Gs(e))throw new Wr(Kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ac(t.Fl.t,t.Fl.persistenceKey);return new bh(e,t.di,n,t.clientId,t.Yl)},e}(bf),wf=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n=this;return Object(N.e)(this,(function(r){switch(r.label){case 0:return this.Ou?[3,2]:(this.Ou=t.Ou,this.Bh=t.Bh,this.Mu=this.Zl(e),this.$h=this.t_(e),this.Lh=this.e_(e),this.va=this.n_(e,!t.synchronizeTabs),this.Bh.pu=function(t){return Sh(n.va,t,1)},this.$h.ku.s_=Gh.bind(null,this.va),[4,Yc(this.$h,this.va.Zh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.e_=function(t){return new eh},t.prototype.Zl=function(t){var e=Iu(t.Fl.t),n=new df(t.Fl);return function(t,e,n){return new jc(t,e,n)}(t.credentials,n,e)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Ou,n=this.Mu,r=t.di,i=function(t){return Sh(s.va,t,0)},o=vf.Gs()?new vf:new yf,new Nc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Th(t,e,n,r,i,o);return s&&(u.Xh=!0),u}(this.Ou,this.$h,this.Lh,this.Bh,t.Yl,t.qh,e)},t.prototype.terminate=function(){return function(t){return Object(N.b)(this,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return e=Gr(t),Mr("RemoteStore","RemoteStore shutting down."),e.Bu.add(5),[4,kc(e)];case 1:return n.sent(),e.Uu.Ic(),e.Ku.set("Unknown"),[2]}}))}))}(this.$h)},t}(),_f=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function If(t,e,n){if(!n)throw new Wr(Kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Ef(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Of(t,e,n,r){if(!0===e&&!0===r)throw new Wr(Kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Tf(t){if(!ci.ot(t))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function jf(t){if(ci.ot(t))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Af(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Br()}function Nf(t,e){if("_delegate"in t&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Wr(Kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Af(t);throw new Wr(Kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Df(t,e){if(e<=0)throw new Wr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var kf=function(t){this._methodName=t},Sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.c_=function(t){if(2!==t.u_)throw t.a_(1===t.u_?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(kf);function xf(t,e,n){return new Ll({u_:3,h_:e.settings.h_,methodName:t._methodName,l_:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Pf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.c_=function(t){return new ps(t.path,new is)},e.prototype.isEqual=function(t){return t instanceof e},e}(kf),Rf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).__=n,r}return Object(N.d)(e,t),e.prototype.c_=function(t){var e=xf(this,t,!0),n=this.__.map((function(t){return Bl(t,e)})),r=new os(n);return new ps(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kf),Cf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).__=n,r}return Object(N.d)(e,t),e.prototype.c_=function(t){var e=xf(this,t,!0),n=this.__.map((function(t){return Bl(t,e)})),r=new us(n);return new ps(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kf),Lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return Object(N.d)(e,t),e.prototype.c_=function(t){var e=new cs(t.serializer,To(t.serializer,this.f_));return new ps(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(kf),Uf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Wr(Kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Wr(Kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.d_=t,this.w_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.d_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.d_===t.d_&&this.w_===t.w_},t.prototype.toJSON=function(){return{latitude:this.d_,longitude:this.w_}},t.prototype.C=function(t){return ti(this.d_,t.d_)||ti(this.w_,t.w_)},t}(),Mf=function(){function t(t){this.E_=t}return t.fromBase64String=function(e){try{return new t(bi.fromBase64String(e))}catch(e){throw new Wr(Kr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(bi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.E_.toBase64()},t.prototype.toUint8Array=function(){return this.E_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.E_.isEqual(t.E_)},t}(),Vf=function(t){this.o_=t},qf=new Map,Ff=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Wr(Kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Wr(Kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Of("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Bf=function(){function t(t,e){this.T_="(lite)",this.I_=new Ff({}),this.m_=!1,t instanceof Rr?(this.A_=t,this.R_=new Jr):(this.P_=t,this.A_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Wr(Kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rr(t.options.projectId)}(t),this.R_=new Xr(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.P_)throw new Wr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.P_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g_",{get:function(){return this.m_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return void 0!==this.V_},enumerable:!1,configurable:!0}),t.prototype.p_=function(t){if(this.m_)throw new Wr(Kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.I_=new Ff(t),void 0!==t.credentials&&(this.R_=function(t){if(!t)return new Jr;switch(t.type){case"gapi":var e=t.client;return zr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Yr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Wr(Kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.v_=function(){return this.I_},t.prototype.b_=function(){return this.m_=!0,this.I_},t.prototype._delete=function(){return this.V_||(this.V_=this.S_()),this.V_},t.prototype.S_=function(){return function(t){var e=qf.get(t);e&&(Mr("ComponentProvider","Removing Datastore"),qf.delete(t),e.terminate())}(this),Promise.resolve()},t}();function zf(){if("undefined"==typeof Uint8Array)throw new Wr(Kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gf(){if("undefined"==typeof atob)throw new Wr(Kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.fromBase64String=function(t){return Gf(),new e(Mf.fromBase64String(t))},e.fromUint8Array=function(t){return zf(),new e(Mf.fromUint8Array(t))},e.prototype.toBase64=function(){return Gf(),this.o_.toBase64()},e.prototype.toUint8Array=function(){return zf(),this.o_.toUint8Array()},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Vf),Wf=function(){function t(){}return t.prototype.D_=function(t,e){switch(void 0===e&&(e="none"),io(t)){case 0:return null;case 1:return t.booleanValue;case 2:return fo(t.integerValue||t.doubleValue);case 3:return this.C_(t.timestampValue);case 4:return this.N_(t,e);case 5:return t.stringValue;case 6:return this.x_(lo(t.bytesValue));case 7:return this.F_(t.referenceValue);case 8:return this.O_(t.geoPointValue);case 9:return this.M_(t.arrayValue,e);case 10:return this.k_(t.mapValue,e);default:throw Br()}},t.prototype.k_=function(t,e){var n=this,r={};return Zi(t.fields||{},(function(t,i){r[t]=n.D_(i,e)})),r},t.prototype.O_=function(t){return new Uf(fo(t.latitude),fo(t.longitude))},t.prototype.M_=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.D_(t,e)}))},t.prototype.N_=function(t,e){switch(e){case"previous":var n=function t(e){var n=e.mapValue.fields.__previous_value__;return eo(n)?t(n):n}(t);return null==n?null:this.D_(n,e);case"estimate":return this.C_(no(t));default:return null}},t.prototype.C_=function(t){var e=ho(t);return new ri(e.seconds,e.nanos)},t.prototype.L_=function(t,e){var n=si.Y(t);zr(Zo(n));var r=new Rr(n.get(1),n.get(3)),i=new ci(n.B(5));return r.isEqual(e)||Vr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Qf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(N.d)(e,t),e.prototype.x_=function(t){return new Kf(new Mf(t))},e.prototype.F_=function(t){var e=this.L_(t,this.firestore.A_);return wp.B_(e,this.firestore,null)},e}(Wf),Jf=function(){function t(t,e,n,r,i){this.q_=t,this.U_=e,this.Q_=n,this.K_=r,this.W_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.Q_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new fl(this.q_,this.W_,this.Q_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.K_},t.prototype.data=function(){if(this.K_){if(this.W_){var t=new Xf(this.q_,this.U_,this.Q_,this.K_,null);return this.W_.fromFirestore(t)}return this.U_.D_(this.K_.En())}},t.prototype.get=function(t){if(this.K_){var e=this.K_.data().field($f("DocumentSnapshot.get",t));if(null!==e)return this.U_.D_(e)}},t}(),Xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Jf);function $f(t,e){return"string"==typeof e?Jl(t,e):e instanceof Vf?e.o_.j_:e.j_}var Yf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new ai(t)}return t.prototype.isEqual=function(t){return this.j_.isEqual(t.j_)},t}(),Hf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).G_=new Bu,r.T_="name"in e?e.name:"[DEFAULT]",r}return Object(N.d)(e,t),e.prototype.S_=function(){return this.z_||gp(this),this.z_.terminate()},e}(Bf);function Zf(t,e,n){var r=this,i=new _u;return t.di.enqueue((function(){return Object(N.b)(r,void 0,void 0,(function(){var r;return Object(N.e)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,tp(t,n)];case 1:return o.sent(),[4,ep(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Kr.FAILED_PRECONDITION||t.code===Kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function tl(t){if(t.g_||t.y_)throw new Wr(Kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var el=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).q_=e,u.H_=e,u.metadata=o,u}return Object(N.d)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.K_){if(this.W_){var e=new nl(this.q_,this.U_,this.Q_,this.K_,this.metadata,null);return this.W_.fromFirestore(e,t)}return this.U_.D_(this.K_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.K_){var n=this.K_.data().field($f("DocumentSnapshot.get",t));if(null!==n)return this.U_.D_(n,e.serverTimestamps)}},e}(Jf),nl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(el),rl=function(){function t(t,e,n,r){this.q_=t,this.U_=e,this.J_=r,this.metadata=new Op(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.J_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.J_.docs.forEach((function(r){t.call(e,new nl(n.q_,n.U_,r.key,r,new Op(n.J_.ee.has(r.key),n.J_.fromCache),n.query.W_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.J_.se)throw new Wr(Kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Y_&&this.X_===e||(this.Y_=function(t,e){if(t.J_.te.W()){var n=0;return t.J_.docChanges.map((function(e){return{type:"added",doc:new nl(t.q_,t.U_,e.doc.key,e.doc,new Op(t.J_.ee.has(e.doc.key),t.J_.fromCache),t.query.W_),oldIndex:-1,newIndex:n++}}))}var r=t.J_.te;return t.J_.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new nl(t.q_,t.U_,e.doc.key,e.doc,new Op(t.J_.ee.has(e.doc.key),t.J_.fromCache),t.query.W_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:il(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.X_=e),this.Y_},t}();function il(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Br()}}function ol(t,e){return t instanceof el&&e instanceof el?t.q_===e.q_&&t.Q_.isEqual(e.Q_)&&(null===t.K_?null===e.K_:t.K_.isEqual(e.K_))&&t.W_===e.W_:t instanceof rl&&e instanceof rl&&t.q_===e.q_&&kl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.J_.isEqual(e.J_)}var sl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(N.d)(e,t),e.prototype.x_=function(t){return new Mf(t)},e.prototype.F_=function(t){var e=this.L_(t,this.firestore.A_);return new fl(this.firestore,null,e)},e}(Wf);function ul(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Nf(t,fl);var o=Nf(t.firestore,Hf),s=Sl(o);return e instanceof Vf&&(e=e.o_),cl(o,("string"==typeof e||e instanceof Yf?ql(s,"updateDoc",t.Q_,e,n,r):Vl(s,"updateDoc",t.Q_,e)).tf(t.Q_,vs.exists(!0)))}function al(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Vf&&(t=t.o_);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Eu(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Eu(i[u])){var l=i[u];i[u]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[u+1]=null===(n=l.error)||void 0===n?void 0:n.bind(l),i[u+2]=null===(r=l.complete)||void 0===r?void 0:r.bind(l)}if(t instanceof fl)c=Nf(t.firestore,Hf),h=qs(t.Q_.path),a={next:function(e){i[u]&&i[u](hl(c,t,e))},error:i[u+1],complete:i[u+2]};else{var p=Nf(t,ll);c=Nf(p.firestore,Hf),h=p.Z_;var d=new sl(c);a={next:function(t){i[u]&&i[u](new rl(c,d,p,t))},error:i[u+1],complete:i[u+2]},Ol(t.Z_)}return function(t,e,n,r){var i=this,o=new _f(r),s=new uh(e,o,n);return t.di.Ri((function(){return Object(N.b)(i,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return e=nh,[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.r_(),t.di.Ri((function(){return Object(N.b)(i,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return e=rh,[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(yp(c),h,f,a)}function cl(t,e){return function(t,e){var n=this,r=new _u;return t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var n;return Object(N.e)(this,(function(i){switch(i.label){case 0:return n=Dh,[4,up(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(yp(t),e)}function hl(t,e,n){var r=n.docs.get(e.Q_),i=new sl(t);return new el(t,i,e.Q_,r,new Op(n.hasPendingWrites,n.fromCache),e.W_)}var fl=function(){function t(t,e,n){this.W_=e,this.Q_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"ef",{get:function(){return this.Q_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.Q_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.Q_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Tl(this.firestore,this.W_,this.Q_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.Q_)},t}(),ll=function(){function t(t,e,n){this.W_=e,this.Z_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.Z_)},t}(),pl=function(){};function dl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.nf(t)}return t}var vl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).sf=e,i.rf=n,i.cf=r,i.type="where",i}return Object(N.d)(e,t),e.prototype.nf=function(t){var e=Sl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Il(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(_l(r,t,h[c]));u={arrayValue:{values:a}}}else u=_l(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Il(s,o),u=Fl(n,"where",s,"in"===o||"not-in"===o);var f=tu.create(i,o,u);return function(t,e){if(e.An()){var n=Gs(t);if(null!==n&&!n.isEqual(e.field))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=zs(t);null!==r&&El(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Wr(Kr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.Z_,0,e,t.firestore.A_,this.sf,this.rf,this.cf);return new ll(t.firestore,t.W_,function(t,e){var n=t.filters.concat([e]);return new Ms(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.Z_,n))},e}(pl),yl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).sf=e,r.uf=n,r.type="orderBy",r}return Object(N.d)(e,t),e.prototype.nf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new pu(e,n);return function(t,e){if(null===zs(t)){var n=Gs(t);null!==n&&El(0,n,e.field)}}(t,r),r}(t.Z_,this.sf,this.uf);return new ll(t.firestore,t.W_,function(t,e){var n=t.Tn.concat([e]);return new Ms(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.Z_,e))},e}(pl),gl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.af=n,i.hf=r,i}return Object(N.d)(e,t),e.prototype.nf=function(t){return new ll(t.firestore,t.W_,Js(t.Z_,this.af,this.hf))},e}(pl),bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.lf=n,i._f=r,i}return Object(N.d)(e,t),e.prototype.nf=function(t){var e=wl(t,this.type,this.lf,this._f);return new ll(t.firestore,t.W_,function(t,e){return new Ms(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.Z_,e))},e}(pl),ml=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.lf=n,i._f=r,i}return Object(N.d)(e,t),e.prototype.nf=function(t){var e=wl(t,this.type,this.lf,this._f);return new ll(t.firestore,t.W_,function(t,e){return new Ms(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.Z_,e))},e}(pl);function wl(t,e,n,r){if(n[0]instanceof Vf&&(n[0]=n[0].o_),n[0]instanceof Jf)return function(t,e,n,r,i){if(!r)throw new Wr(Kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Ws(t);s<u.length;s++){var a=u[s];if(a.field.tt())o.push(po(e,r.key));else{var c=r.field(a.field);if(eo(c))throw new Wr(Kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new cu(o,i)}(t.Z_,t.firestore.A_,e,n[0].K_,r);var i=Sl(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Wr(Kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ks(t)&&-1!==c.indexOf("/"))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(si.Y(c));if(!ci.ot(h))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ci(h);u.push(po(e,f))}else{var l=Fl(n,r,c);u.push(l)}}return new cu(u,o)}(t.Z_,t.firestore.A_,i,e,n,r)}function _l(t,e,n){if(n instanceof Vf&&(n=n.o_),"string"==typeof n){if(""===n)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ks(e)&&-1!==n.indexOf("/"))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(si.Y(n));if(!ci.ot(r))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return po(t,new ci(r))}if(n instanceof fl)return po(t,n.Q_);throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Af(n)+".")}function Il(t,e){if(!Array.isArray(t)||0===t.length)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function El(t,e,n){if(!n.isEqual(e))throw new Wr(Kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ol(t){if(Bs(t)&&0===t.Tn.length)throw new Wr(Kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tl=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,qs(r))||this).firestore=e,i.ef=r,i.type="collection",i}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Z_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Z_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.ef.q();return t.W()?null:new fl(this.firestore,null,new ci(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.ef)},e}(ll);function jl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof Vf&&(t=t.o_),If("collection","path",e),t instanceof Bf){var i=si.Y.apply(si,Object(N.h)([e],n));return jf(i),new Tl(t,null,i)}if(!(t instanceof fl||t instanceof Tl))throw new Wr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=si.Y.apply(si,Object(N.h)([t.path],n)).child(si.Y(e));return jf(o),new Tl(t.firestore,null,o)}function Al(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t instanceof Vf&&(t=t.o_),1===arguments.length&&(e=Zr.D()),If("doc","path",e),t instanceof Bf){var i=si.Y.apply(si,Object(N.h)([e],n));return Tf(i),new fl(t,null,new ci(i))}if(!(t instanceof fl||t instanceof Tl))throw new Wr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.ef.child(si.Y.apply(si,Object(N.h)([e],n)));return Tf(o),new fl(t.firestore,t instanceof Tl?t.W_:null,new ci(o))}var Nl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(N.d)(e,t),e.prototype.x_=function(t){return new Mf(t)},e.prototype.F_=function(t){var e=this.L_(t,this.firestore.A_);return new fl(this.firestore,null,e)},e}(Wf);function Dl(t,e){return t instanceof Vf&&(t=t.o_),e instanceof Vf&&(e=e.o_),(t instanceof fl||t instanceof Tl)&&(e instanceof fl||e instanceof Tl)&&t.firestore===e.firestore&&t.path===e.path&&t.W_===e.W_}function kl(t,e){return t instanceof Vf&&(t=t.o_),e instanceof Vf&&(e=e.o_),t instanceof ll&&e instanceof ll&&t.firestore===e.firestore&&Xs(t.Z_,e.Z_)&&t.W_===e.W_}function Sl(t){var e=t.b_(),n=Iu(t.A_);return new Ul(t.A_,!!e.ignoreUndefinedProperties,n)}var xl=/^__.*__$/,Pl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.tf=function(t,e){var n=[];return n.push(null!==this.en?new Os(t,this.data,this.en,e):new Es(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new js(t,this.fieldTransforms)),n},t}(),Rl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.tf=function(t,e){var n=[new Os(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new js(t,this.fieldTransforms)),n},t}();function Cl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Br()}}var Ll=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ff(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"u_",{get:function(){return this.settings.u_},enumerable:!1,configurable:!0}),t.prototype.df=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.wf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.df({path:n,l_:!1});return r.Ef(t),r},t.prototype.Tf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.df({path:n,l_:!1});return r.ff(),r},t.prototype.If=function(t){return this.df({path:void 0,l_:!0})},t.prototype.a_=function(t){return Xl(t,this.settings.methodName,this.settings.mf||!1,this.path,this.settings.h_)},t.prototype.contains=function(t){return void 0!==this.en.find((function(e){return t.j(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.j(e.field)}))},t.prototype.ff=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ef(this.path.get(t))},t.prototype.Ef=function(t){if(0===t.length)throw this.a_("Document fields must not be empty");if(Cl(this.u_)&&xl.test(t))throw this.a_('Document fields cannot begin and end with "__"')},t}(),Ul=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Iu(t)}return t.prototype.Af=function(t,e,n,r){return void 0===r&&(r=!1),new Ll({u_:t,methodName:e,h_:n,path:ai.X(),l_:!1,mf:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Ml(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Af(o.merge||o.mergeFields?2:0,e,n,i);Kl("Data must be an object, but it was:",s,r);var u,a,c=zl(r,s);if(o.merge)u=new ls(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=Wl(e,l[f],n);if(!s.contains(p))throw new Wr(Kr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");$l(h,p)||h.push(p)}u=new ls(h),a=s.fieldTransforms.filter((function(t){return u.un(t.field)}))}else u=null,a=s.fieldTransforms;return new Pl(new Ss(c),u,a)}function Vl(t,e,n,r){var i=t.Af(1,e,n);Kl("Data must be an object, but it was:",i,r);var o=[],s=new xs;Zi(r,(function(t,r){var u=Jl(e,t,n);r instanceof Vf&&(r=r.o_);var a=i.Tf(u);if(r instanceof Sf)o.push(u);else{var c=Bl(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new ls(o);return new Rl(s.hn(),u,i.fieldTransforms)}function ql(t,e,n,r,i,o){var s=t.Af(1,e,n),u=[Wl(e,r,n)],a=[i];if(o.length%2!=0)throw new Wr(Kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Wl(e,o[c])),a.push(o[c+1]);for(var h=[],f=new xs,l=u.length-1;l>=0;--l)if(!$l(h,u[l])){var p=u[l],d=a[l];d instanceof Vf&&(d=d.o_);var v=s.Tf(p);if(d instanceof Sf)h.push(p);else{var y=Bl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new ls(h);return new Rl(f.hn(),g,s.fieldTransforms)}function Fl(t,e,n,r){return void 0===r&&(r=!1),Bl(n,t.Af(r?4:3,e))}function Bl(t,e){if(t instanceof Vf&&(t=t.o_),Gl(t))return Kl("Unsupported field value:",e,t),zl(t,e);if(t instanceof kf)return function(t,e){if(!Cl(e.u_))throw e.a_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.a_(t._methodName+"() is not currently supported inside arrays");var n=t.c_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.l_&&4!==e.u_)throw e.a_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Bl(o[i],e.If(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Vf&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return To(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ri.fromDate(t);return{timestampValue:jo(e.serializer,n)}}if(t instanceof ri){var r=new ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jo(e.serializer,r)}}if(t instanceof Uf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Mf)return{bytesValue:Ao(e.serializer,t.E_)};if(t instanceof fl){var i=e.t,o=t.firestore.A_;if(!o.isEqual(i))throw e.a_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ko(t.firestore.A_||e.t,t.Q_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.a_("Unsupported field value: "+Af(t))}(t,e)}function zl(t,e){var n={};return to(t)?e.path&&e.path.length>0&&e.en.push(e.path):Zi(t,(function(t,r){var i=Bl(r,e.wf(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Gl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ri||t instanceof Uf||t instanceof Mf||t instanceof fl||t instanceof kf)}function Kl(t,e,n){if(!Gl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Af(n);throw e.a_("an object"===r?t+" a custom object":t+" "+r)}}function Wl(t,e,n){if(e instanceof Vf&&(e=e.o_),e instanceof Yf)return e.j_;if("string"==typeof e)return Jl(t,e);throw Xl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ql=new RegExp("[~\\*/\\[\\]]");function Jl(t,e,n){if(e.search(Ql)>=0)throw Xl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Yf.bind.apply(Yf,Object(N.h)([void 0],e.split("."))))).j_}catch(r){throw Xl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Xl(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Wr(Kr.INVALID_ARGUMENT,(u+=". ")+t+a)}function $l(t,e){return t.some((function(t){return t.isEqual(e)}))}var Yl=function(){function t(t){this.Mu=t,this.Rf=new Map,this.mutations=[],this.Pf=!1,this.gf=null,this.yf=new Set}return t.prototype.Vf=function(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n=this;return Object(N.e)(this,(function(r){switch(r.label){case 0:if(this.pf(),this.mutations.length>0)throw new Wr(Kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i,o,s,u;return Object(N.e)(this,(function(a){switch(a.label){case 0:return n=Gr(t),r=Lo(n.serializer)+"/documents",i={documents:e.map((function(t){return xo(n.serializer,t)}))},[4,n.Vu("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){zr(!!e.found);var n=Po(t,e.found.name),r=Do(e.found.updateTime),i=new Ss({mapValue:{fields:e.found.fields}});return new Cs(n,r,i,{})}(t,e):"missing"in e?function(t,e){zr(!!e.missing),zr(!!e.readTime);var n=Po(t,e.missing),r=Do(e.readTime);return new Ls(n,r)}(t,e):Br()}(n.serializer,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());zr(!!e),u.push(e)})),u)]}}))}))}(this.Mu,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Ls||t instanceof Cs?n.vf(t):Br()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.tf(t,this.rn(t))),this.yf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.tf(t,this.bf(t)))}catch(t){this.gf=t}this.yf.add(t.toString())},t.prototype.delete=function(t){this.write([new Ds(t,this.rn(t))]),this.yf.add(t.toString())},t.prototype.commit=function(){return Object(N.b)(this,void 0,void 0,(function(){var t,e=this;return Object(N.e)(this,(function(n){switch(n.label){case 0:if(this.pf(),this.gf)throw this.gf;return t=this.Rf,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ci.st(n);e.mutations.push(new ks(r,e.rn(r)))})),[4,function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r,i;return Object(N.e)(this,(function(o){switch(o.label){case 0:return n=Gr(t),r=Lo(n.serializer)+"/documents",i={writes:e.map((function(t){return Vo(n.serializer,t)}))},[4,n.yu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Mu,this.mutations)];case 1:return n.sent(),this.Pf=!0,[2]}}))}))},t.prototype.vf=function(t){var e;if(t instanceof Cs)e=t.version;else{if(!(t instanceof Ls))throw Br();e=ii.min()}var n=this.Rf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Wr(Kr.ABORTED,"Document version changed between two reads.")}else this.Rf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Rf.get(t.toString());return!this.yf.has(t.toString())&&e?vs.updateTime(e):vs.on()},t.prototype.bf=function(t){var e=this.Rf.get(t.toString());if(!this.yf.has(t.toString())&&e){if(e.isEqual(ii.min()))throw new Wr(Kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)}return vs.exists(!0)},t.prototype.write=function(t){this.pf(),this.mutations=this.mutations.concat(t)},t.prototype.pf=function(){},t}(),Hl=function(){function t(t,e,n,r){this.di=t,this.Mu=e,this.updateFunction=n,this.Ti=r,this.Sf=5,this.Si=new Du(this.di,"transaction_retry")}return t.prototype.run=function(){this.Df()},t.prototype.Df=function(){var t=this;this.Si.Bs((function(){return Object(N.b)(t,void 0,void 0,(function(){var t,e,n=this;return Object(N.e)(this,(function(r){return t=new Yl(this.Mu),(e=this.Cf(t))&&e.then((function(e){n.di.Ri((function(){return t.commit().then((function(){n.Ti.resolve(e)})).catch((function(t){n.Nf(t)}))}))})).catch((function(t){n.Nf(t)})),[2]}))}))}))},t.prototype.Cf=function(t){try{var e=this.updateFunction(t);return!hi(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.Nf=function(t){var e=this;this.Sf>0&&this.xf(t)?(this.Sf-=1,this.di.Ri((function(){return e.Df(),Promise.resolve()}))):this.Ti.reject(t)},t.prototype.xf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ei(e)}return!1},t}(),Zl=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Cr.UNAUTHENTICATED,this.clientId=Zr.D(),this.Ff=function(){},this.g=new _u,this.credentials.A((function(t){Mr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Ff(t)),r.g.resolve()}))}return t.prototype.getConfiguration=function(){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,qh:100})]}}))}))},t.prototype.Of=function(t){var e=this;this.Ff=t,this.g.promise.then((function(){return e.Ff(e.user)}))},t.prototype.Mf=function(){if(this.di.Ci)throw new Wr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new _u;return this.di.Ni((function(){return Object(N.b)(t,void 0,void 0,(function(){var t,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.kf?[4,this.kf.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.$f?[4,this.$f.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=zu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function tp(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r=this;return Object(N.e)(this,(function(i){switch(i.label){case 0:return t.di.Li(),Mr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Of((function(n){return t.di.Mi((function(){return Object(N.b)(r,void 0,void 0,(function(){return Object(N.e)(this,(function(t){switch(t.label){case 0:return[4,fc(e.Ou,n)];case 1:return t.sent(),[2]}}))}))}))})),e.persistence.rc((function(){return t.terminate()})),t.$f=e,[2]}}))}))}function ep(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r;return Object(N.e)(this,(function(i){switch(i.label){case 0:return t.di.Li(),[4,np(t)];case 1:return n=i.sent(),Mr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Of((function(n){return t.di.Mi((function(){return function(t,e){return Object(N.b)(this,void 0,void 0,(function(){var n,r;return Object(N.e)(this,(function(i){switch(i.label){case 0:return(n=Gr(t)).di.Li(),Mr("RemoteStore","RemoteStore received new credentials"),r=Uc(n),n.Bu.add(3),[4,kc(n)];case 1:return i.sent(),r&&n.Ku.set("Unknown"),[4,n.ku.s_(e)];case 2:return i.sent(),n.Bu.delete(3),[4,Dc(n)];case 3:return i.sent(),[2]}}))}))}(e.$h,n)}))})),t.kf=e,[2]}}))}))}function np(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return t.$f?[3,2]:(Mr("FirestoreClient","Using default OfflineComponentProvider"),[4,tp(t,new gf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}}))}))}function rp(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return t.kf?[3,2]:(Mr("FirestoreClient","Using default OnlineComponentProvider"),[4,ep(t,new wf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.kf]}}))}))}function ip(t){return np(t).then((function(t){return t.persistence}))}function op(t){return np(t).then((function(t){return t.Ou}))}function sp(t){return rp(t).then((function(t){return t.$h}))}function up(t){return rp(t).then((function(t){return t.va}))}function ap(t){return Object(N.b)(this,void 0,void 0,(function(){var e,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:return[4,rp(t)];case 1:return e=r.sent(),[2,((n=e.Lh).ta=jh.bind(null,e.va),n.sa=Nh.bind(null,e.va),n)]}}))}))}function cp(t,e,n){var r=this;void 0===n&&(n={});var i=new _u;return t.di.Ri((function(){return Object(N.b)(r,void 0,void 0,(function(){var r;return Object(N.e)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new _f({next:function(o){e.Ri((function(){return rh(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Wr(Kr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Wr(Kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new uh(qs(n.path),o,{includeMetadataChanges:!0,ha:!0});return nh(t,s)},[4,ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.di,e,n,i])]}}))}))})),i.promise}function hp(t,e,n){var r=this;void 0===n&&(n={});var i=new _u;return t.di.Ri((function(){return Object(N.b)(r,void 0,void 0,(function(){var r;return Object(N.e)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new _f({next:function(n){e.Ri((function(){return rh(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Wr(Kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new uh(n,o,{includeMetadataChanges:!0,ha:!0});return nh(t,s)},[4,ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.di,e,n,i])]}}))}))})),i.promise}var fp=function(){function t(t,e){this.q_=t,this.Lf=e,this.Bf=[],this.qf=!1,this.Uf=Sl(t)}return t.prototype.set=function(t,e,n){this.Qf();var r=lp(t,this.q_),i=xp(r.W_,e,n),o=Ml(this.Uf,"WriteBatch.set",r.Q_,i,null!==r.W_,n);return this.Bf=this.Bf.concat(o.tf(r.Q_,vs.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Qf();var o,s=lp(t,this.q_);return e instanceof Vf&&(e=e.o_),o="string"==typeof e||e instanceof Yf?ql(this.Uf,"WriteBatch.update",s.Q_,e,n,r):Vl(this.Uf,"WriteBatch.update",s.Q_,e),this.Bf=this.Bf.concat(o.tf(s.Q_,vs.exists(!0))),this},t.prototype.delete=function(t){this.Qf();var e=lp(t,this.q_);return this.Bf=this.Bf.concat(new Ds(e.Q_,vs.on())),this},t.prototype.commit=function(){return this.Qf(),this.qf=!0,this.Bf.length>0?this.Lf(this.Bf):Promise.resolve()},t.prototype.Qf=function(){if(this.qf)throw new Wr(Kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function lp(t,e){if(t instanceof Vf&&(t=t.o_),t.firestore!==e)throw new Wr(Kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).q_=e,r}return Object(N.d)(e,t),e.prototype.get=function(e){var n=this,r=lp(e,this.q_),i=new sl(this.q_);return t.prototype.get.call(this,e).then((function(t){return new el(n.q_,i,r.Q_,t.K_,new Op(!1,!1),r.W_)}))},e}(function(){function t(t,e){this.q_=t,this.Kf=e,this.Uf=Sl(t)}return t.prototype.get=function(t){var e=this,n=lp(t,this.q_),r=new Nl(this.q_);return this.Kf.Vf([n.Q_]).then((function(t){if(!t||1!==t.length)return Br();var i=t[0];if(i instanceof Ls)return new Jf(e.q_,r,n.Q_,null,n.W_);if(i instanceof Cs)return new Jf(e.q_,r,i.key,i,n.W_);throw Br()}))},t.prototype.set=function(t,e,n){var r=lp(t,this.q_),i=xp(r.W_,e,n),o=Ml(this.Uf,"Transaction.set",r.Q_,i,null!==r.W_,n);return this.Kf.set(r.Q_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=lp(t,this.q_);return e instanceof Vf&&(e=e.o_),o="string"==typeof e||e instanceof Yf?ql(this.Uf,"Transaction.update",s.Q_,e,n,r):Vl(this.Uf,"Transaction.update",s.Q_,e),this.Kf.update(s.Q_,o),this},t.prototype.delete=function(t){var e=lp(t,this.q_);return this.Kf.delete(e.Q_),this},t}()),dp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){tl(t=Nf(t,Hf));var n=yp(t),r=t.b_(),i=new wf;return Zf(n,i,new bf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){tl(t=Nf(t,Hf));var e=yp(t),n=t.b_(),r=new wf;return Zf(e,r,new mf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.g_&&!t.y_)throw new Wr(Kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new _u;return t.G_.Ni((function(){return Object(N.b)(e,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(N.b)(this,void 0,void 0,(function(){return Object(N.e)(this,(function(e){switch(e.label){case 0:return ku.Gs()?[4,ku.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(ac(t.A_,t.T_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.o_)},t}(),vp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Wf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Rr||(i.jf=e),i}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"A_",{get:function(){return this.o_.A_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.v_()),t)).merge,this.o_.p_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.v_().host&&qr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.di.enqueue((function(){return Object(N.b)(e,void 0,void 0,(function(){var e,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,sp(t)];case 2:return n=r.sent(),[2,(e.oc(!0),function(t){var e=Gr(t);return e.Bu.delete(0),Dc(e)}(n))]}}))}))}))}(yp(Nf(this.o_,Hf)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.di.enqueue((function(){return Object(N.b)(e,void 0,void 0,(function(){var e,n;return Object(N.e)(this,(function(r){switch(r.label){case 0:return[4,ip(t)];case 1:return e=r.sent(),[4,sp(t)];case 2:return n=r.sent(),[2,(e.oc(!1),function(t){return Object(N.b)(this,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return(e=Gr(t)).Bu.add(0),[4,kc(e)];case 1:return n.sent(),e.Ku.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(yp(Nf(this.o_,Hf)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Of("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Wf.enableMultiTabIndexedDbPersistence(this):this.Wf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Wf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new _u;return t.di.Ri((function(){return Object(N.b)(e,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(r){switch(r.label){case 0:return e=Ch,[4,up(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(yp(Nf(this.o_,Hf)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new _f(e);return t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Gr(t).Zu.add(e),e.next()},[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.r_(),t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var e;return Object(N.e)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Gr(t).Zu.delete(e)},[4,ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(yp(t=Nf(t,Hf)),Eu(e)?e:{next:e})}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.jf)throw new Wr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.jf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new kp(this,jl(this.o_,t))}catch(t){throw _p(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new wp(this,Al(this.o_,t))}catch(t){throw _p(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Ap(this,function(t,e){if(t=Nf(t,Bf),If("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ll(t,null,function(t){return new Ms(si.X(),t)}(e))}(this.o_,t))}catch(t){throw _p(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new _u;return t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var n;return Object(N.e)(this,(function(i){switch(i.label){case 0:return[4,function(t){return rp(t).then((function(t){return t.Mu}))}(t)];case 1:return n=i.sent(),new Hl(t.di,n,e,r).run(),[2]}}))}))})),r.promise}(yp(t),(function(n){return e(new pp(t,n))}))}(this.o_,(function(n){return t(new bp(e,n))}))},e.prototype.batch=function(){var t=this;return yp(this.o_),new mp(new fp(this.o_,(function(e){return cl(t.o_,e)})))},e}(Vf);function yp(t){return t.z_||gp(t),t.z_.Mf(),t.z_}function gp(t){var e=t.b_(),n=function(t,e,n){return new Pr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.A_,t.T_,e);t.z_=new Zl(t.R_,t.G_,n)}var bp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).q_=e,r}return Object(N.d)(e,t),e.prototype.get=function(t){var e=this,n=Sp(t);return this.o_.get(n).then((function(t){return new Tp(e.q_,t)}))},e.prototype.set=function(t,e,n){var r=Sp(t);return n?(Ef("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Sp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(N.h)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Sp(t);return this.o_.delete(e),this},e}(Vf),mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.set=function(t,e,n){var r=Sp(t);return n?(Ef("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Sp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,Object(N.h)([s,e,n],i)),this},e.prototype.delete=function(t){var e=Sp(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(Vf),wp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.U_=new Qf(e),r}return Object(N.d)(e,t),e.Gf=function(t,n,r){if(t.length%2!=0)throw new Wr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new fl(n.o_,r,new ci(t)))},e.B_=function(t,n,r){return new e(n,new fl(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new kp(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new kp(this.firestore,jl(this.o_,t))}catch(t){throw _p(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Vf&&(t=t.o_),t instanceof fl&&Dl(this.o_,t)},e.prototype.set=function(t,e){e=Ef("DocumentReference.set",e);try{return function(t,e,n){t=Nf(t,fl);var r=Nf(t.firestore,Hf),i=xp(t.W_,e,n);return cl(r,Ml(Sl(r),"setDoc",t.Q_,i,null!==t.W_,n).tf(t.Q_,vs.on()))}(this.o_,t,e)}catch(t){throw _p(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ul(this.o_,t):ul.apply(void 0,Object(N.h)([this.o_,t,e],n))}catch(t){throw _p(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return cl(Nf((t=this.o_).firestore,Hf),[new Ds(t.Q_,vs.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ip(e),i=Ep(e,(function(e){return new Tp(t.firestore,new el(t.firestore.o_,t.U_,e.Q_,e.K_,e.metadata,t.o_.W_))}));return al(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Nf(t,fl);var e=Nf(t.firestore,Hf),n=yp(e),r=new sl(e);return function(t,e){var n=this,r=new _u;return t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var n;return Object(N.e)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o;return Object(N.e)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Gr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Bc.cs(t,e)}))}(t,e)];case 1:return(r=s.sent())instanceof Cs?n.resolve(r):r instanceof Ls?n.resolve(null):n.reject(new Wr(Kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=zu(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))},[4,op(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.Q_).then((function(n){return new el(e,r,t.Q_,n,new Op(n instanceof Cs&&n.an,!0),t.W_)}))}(this.o_):"server"===(null==t?void 0:t.source)?function(t){t=Nf(t,fl);var e=Nf(t.firestore,Hf);return cp(yp(e),t.Q_,{source:"server"}).then((function(n){return hl(e,t,n)}))}(this.o_):function(t){t=Nf(t,fl);var e=Nf(t.firestore,Hf);return cp(yp(e),t.Q_).then((function(n){return hl(e,t,n)}))}(this.o_)).then((function(t){return new Tp(e.firestore,new el(e.firestore.o_,e.U_,t.Q_,t.K_,t.metadata,e.o_.W_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Vf);function _p(t,e,n){return t.message=t.message.replace(e,n),t}function Ip(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Eu(r))return r}return{}}function Ep(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Eu(t[0])?t[0]:Eu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Op=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Tp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).q_=e,r}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new wp(this.q_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return ol(this.o_,t.o_)},e}(Vf),jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(Tp),Ap=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.U_=new Qf(e),r}return Object(N.d)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,dl(this.o_,function(t,e,n){var r=e,i=$f("where",t);return new vl(i,r,n)}(t,n,r)))}catch(t){throw _p(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,dl(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=$f("orderBy",t);return new yl(r,n)}(t,n)))}catch(t){throw _p(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,dl(this.o_,function(t){return Df("limit",t),new gl("limit",t,"F")}(t)))}catch(t){throw _p(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,dl(this.o_,function(t){return Df("limitToLast",t),new gl("limitToLast",t,"L")}(t)))}catch(t){throw _p(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("startAt",t,!0)}).apply(void 0,t)))}catch(t){throw _p(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bl("startAfter",t,!1)}).apply(void 0,t)))}catch(t){throw _p(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ml("endBefore",t,!0)}).apply(void 0,t)))}catch(t){throw _p(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,dl(this.o_,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ml("endAt",t,!1)}).apply(void 0,t)))}catch(t){throw _p(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return kl(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Nf(t,ll);var e=Nf(t.firestore,Hf),n=yp(e),r=new sl(e);return function(t,e){var n=this,r=new _u;return t.di.Ri((function(){return Object(N.b)(n,void 0,void 0,(function(){var n;return Object(N.e)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(N.b)(this,void 0,void 0,(function(){var r,i,o,s,u,a;return Object(N.e)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,bc(t,e,!0)];case 1:return r=c.sent(),i=new Ih(e,r.Kc),o=i.bh(r.documents),s=i.Zn(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=c.sent(),a=zu(u,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,op(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.Z_).then((function(n){return new rl(e,r,t,n)}))}(this.o_):"server"===(null==t?void 0:t.source)?function(t){t=Nf(t,ll);var e=Nf(t.firestore,Hf),n=yp(e),r=new sl(e);return hp(n,t.Z_,{source:"server"}).then((function(n){return new rl(e,r,t,n)}))}(this.o_):function(t){t=Nf(t,ll);var e=Nf(t.firestore,Hf),n=yp(e),r=new sl(e);return Ol(t.Z_),hp(n,t.Z_).then((function(n){return new rl(e,r,t,n)}))}(this.o_)).then((function(t){return new Dp(e.firestore,new rl(e.firestore.o_,e.U_,e.o_,t.J_))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ip(e),i=Ep(e,(function(e){return new Dp(t.firestore,new rl(t.firestore.o_,t.U_,t.o_,e.J_))}));return al(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Vf),Np=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).q_=e,r}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new jp(this.q_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(Vf),Dp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).q_=e,r}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Ap(this.q_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map((function(e){return new jp(t.q_,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map((function(t){return new Np(e.q_,t)}))},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach((function(r){t.call(e,new jp(n.q_,r))}))},e.prototype.isEqual=function(t){return ol(this.o_,t.o_)},e}(Vf),kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return Object(N.d)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new wp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new wp(this.firestore,void 0===t?Al(this.o_):Al(this.o_,t))}catch(t){throw _p(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Nf(t.firestore,Hf),r=Al(t),i=xp(t.W_,e);return cl(n,Ml(Sl(t.firestore),"addDoc",r.Q_,i,null!==t.W_,{}).tf(r.Q_,vs.exists(!1))).then((function(){return r}))}(this.o_,t).then((function(t){return new wp(e.firestore,t)}))},e.prototype.isEqual=function(t){return Dl(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Ap);function Sp(t){return t instanceof Vf&&(t=t.o_),Nf(t,fl)}function xp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Pp,Rp=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Yf.bind.apply(Yf,Object(N.h)([void 0],e))))||this}return Object(N.d)(e,t),e.documentId=function(){return new e(ai.et().J())},e.prototype.isEqual=function(t){return t instanceof Vf&&(t=t.o_),t instanceof Yf&&this.o_.j_.isEqual(t.j_)},e}(Vf),Cp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(N.d)(e,t),e.serverTimestamp=function(){var t=new Pf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Sf("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Rf("arrayUnion",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cf("arrayRemove",t)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Lf("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(Vf),Lp={Firestore:vp,GeoPoint:Uf,Timestamp:ri,Blob:Kf,Transaction:bp,WriteBatch:mp,DocumentReference:wp,DocumentSnapshot:Tp,Query:Ap,QueryDocumentSnapshot:jp,QuerySnapshot:Dp,CollectionReference:kp,FieldPath:Rp,FieldValue:Cp,setLogLevel:function(t){Lr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new xr.a("firestore",(function(t){return function(t,e){return new vp(t,new Hf(t,e),new dp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Lp)))})(Pp=D.a),Pp.registerVersion("@firebase/firestore","2.0.5");var Up=u("UbJi");function Mp(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.a;return new l.a((function(n){var r;return null!=e?e.schedule((function(){r=t.onSnapshot({includeMetadataChanges:!0},n)})):r=t.onSnapshot({includeMetadataChanges:!0},n),function(){null!=r&&r()}}))}(t,e)}function Vp(t,e){return Mp(t,e).pipe(Object(w.a)((function(t){return{payload:t,type:"query"}})))}function qp(t,e){return Vp(t,e).pipe(Object(v.a)(void 0),g(),Object(w.a)((function(t){var e=n(t,2),r=e[0],i=e[1],o=i.payload.docChanges(),s=o.map((function(t){return{type:t.type,payload:t}}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((function(t,e){var n=o.find((function(e){return e.doc.ref.isEqual(t.ref)})),i=null==r?void 0:r.payload.docs.find((function(e){return e.ref.isEqual(t.ref)}));n&&JSON.stringify(n.doc.metadata)===JSON.stringify(t.metadata)||!n&&i&&JSON.stringify(i.metadata)===JSON.stringify(t.metadata)||s.push({type:"modified",payload:{oldIndex:e,newIndex:e,type:"modified",doc:t}})})),s})))}function Fp(t,e,n){return qp(t,n).pipe(Object(_.a)((function(t,n){return function(t,e,n){return e.forEach((function(e){n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Bp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){var n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Bp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Bp(t,e.oldIndex,1)}return t}(t,e))})),t}(t,n.map((function(t){return t.payload})),e)}),[]),Object(I.a)(),Object(w.a)((function(t){return t.map((function(t){return{type:t.type,payload:t}}))})))}function Bp(t,e,n){for(var r=t.slice(),i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return r.splice.apply(r,[e,n].concat(o)),r}function zp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}var Gp=function(){function r(t,e,n){c(this,r),this.ref=t,this.query=e,this.afs=n}return f(r,[{key:"stateChanges",value:function(t){var e=qp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(w.a)((function(e){return e.filter((function(e){return t.indexOf(e.type)>-1}))})))),e.pipe(Object(v.a)(void 0),g(),Object(E.a)((function(t){var e=n(t,2),r=e[0];return e[1].length>0||!r})),Object(w.a)((function(t){var e=n(t,2);e[0];return e[1]})),this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(_.a)((function(t,n){return[].concat(e(t),e(n))}),[]))}},{key:"snapshotChanges",value:function(t){var e=zp(t);return Fp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)((function(n){return n.payload.docs.map((function(n){return e.idField?Object.assign(Object.assign({},n.data()),t({},e.idField,n.id)):n.data()}))})),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(p.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}},{key:"add",value:function(t){return this.ref.add(t)}},{key:"doc",value:function(t){return new Kp(this.ref.doc(t),this.afs)}}]),r}(),Kp=function(){function e(t,n){c(this,e),this.ref=t,this.afs=n}return f(e,[{key:"set",value:function(t,e){return this.ref.set(t,e)}},{key:"update",value:function(t){return this.ref.update(t)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(t,e){var n=Yp(this.ref.collection(t),e),r=n.ref,i=n.query;return new Gp(r,i,this.afs)}},{key:"snapshotChanges",value:function(){return Mp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(v.a)(void 0),g(),Object(w.a)((function(t){var e=n(t,2),r=e[0],i=e[1];return i.exists?(null==r?void 0:r.exists)?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.snapshotChanges().pipe(Object(w.a)((function(n){var r=n.payload;return e.idField?Object.assign(Object.assign({},r.data()),t({},e.idField,r.id)):r.data()})))}},{key:"get",value:function(t){return Object(p.a)(this.ref.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}]),e}(),Wp=function(){function n(t,e){c(this,n),this.query=t,this.afs=e}return f(n,[{key:"stateChanges",value:function(t){return t&&0!==t.length?qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)((function(e){return e.filter((function(e){return t.indexOf(e.type)>-1}))})),Object(E.a)((function(t){return t.length>0})),this.afs.keepUnstableUntilFirst):qp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Object(_.a)((function(t,n){return[].concat(e(t),e(n))}),[]))}},{key:"snapshotChanges",value:function(t){var e=zp(t);return Fp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(w.a)((function(n){return n.payload.docs.map((function(n){return e.idField?Object.assign(t({},e.idField,n.id),n.data()):n.data()}))})),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(t){return Object(p.a)(this.query.get(t)).pipe(Object(O.b)(this.afs.schedulers.insideAngular))}}]),n}(),Qp=new a.q("angularfire2.enableFirestorePersistence"),Jp=new a.q("angularfire2.firestore.persistenceSettings"),Xp=new a.q("angularfire2.firestore.settings"),$p=new a.q("angularfire2.firestore.use-emulator");function Yp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return{query:e(t),ref:t}}var Hp,Zp=((Hp=function(){function t(r,i,o,s,u,a,h,f,l){c(this,t),this.schedulers=new T.d(a),this.keepUnstableUntilFirst=Object(T.h)(this.schedulers);var v=Object(T.g)(r,a,i);!A.a.auth&&l&&Object(T.j)();var y=f,g=n(Object(T.f)(v.name+".firestore","AngularFirestore",v,(function(){var t=a.runOutsideAngular((function(){return v.firestore()}));return s&&t.settings(s),y&&t.useEmulator.apply(t,e(y)),o&&!Object(j.n)(u)?[t,a.runOutsideAngular((function(){try{return Object(p.a)(t.enablePersistence(h||void 0).then((function(){return!0}),(function(){return!1})))}catch(e){return"undefined"!=typeof console&&console.warn(e),Object(d.a)(!1)}}))]:[t,Object(d.a)(!1)]}),[s,y,o]),2);this.firestore=g[0],this.persistenceEnabled$=g[1]}return f(t,[{key:"collection",value:function(t,e){var n=Yp("string"==typeof t?this.firestore.collection(t):t,e),r=n.ref,i=n.query,o=this.schedulers.ngZone.run((function(){return r}));return new Gp(o,i,this)}},{key:"collectionGroup",value:function(t,e){var n=e||function(t){return t},r=this.firestore.collectionGroup(t);return new Wp(n(r),this)}},{key:"doc",value:function(t){var e;e="string"==typeof t?this.firestore.doc(t):t;var n=this.schedulers.ngZone.run((function(){return e}));return new Kp(n,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),t}()).\u0275fac=function(t){return new(t||Hp)(a.Pb(T.c),a.Pb(T.b,8),a.Pb(Qp,8),a.Pb(Xp,8),a.Pb(a.B),a.Pb(a.z),a.Pb(Jp,8),a.Pb($p,8),a.Pb(Up.c,8))},Hp.\u0275prov=Object(a.Eb)({factory:function(){return new Hp(Object(a.Pb)(T.c),Object(a.Pb)(T.b,8),Object(a.Pb)(Qp,8),Object(a.Pb)(Xp,8),Object(a.Pb)(a.B),Object(a.Pb)(a.z),Object(a.Pb)(Jp,8),Object(a.Pb)($p,8),Object(a.Pb)(Up.c,8))},token:Hp,providedIn:"any"}),Hp)},tB1I:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r,i=n("Jgta"),o=n("fXoL"),s=n("I/3d"),u=n("UbJi"),a=n("tyNb"),h=n("Vaw3"),l=((r=function(){function t(e,n,r,i){c(this,t),this.firestore=e,this.firebaseAuth=n,this.router=r,this.firestorage=i,this.userAuthInfo=[],this.user=[],this.username="",this.accountsArray=[],this.profileFile={},this.storageRef={},this.sendFileTaskObject={},this.newProfileFile={},this.newDisplayName="",this.creepDetailsArray=[],this.editDisplayName="",this.indivFireData=[],this.editDescription="",this.editLooking=""}return f(t,[{key:"login",value:function(t){var e=this;console.log(t),i.a.auth().signOut(),this.userAuthInfo=t,i.a.auth().signInWithEmailAndPassword(this.userAuthInfo[0],this.userAuthInfo[1]).catch((function(t){var e=t.message;"auth/weak-password"==t.code?alert("the Password is too weak"):alert(e),console.log(t)})),this.firebaseAuth.onAuthStateChanged((function(t){t&&(console.log(t),e.user=t,e.router.navigate(["/browse"]))}))}},{key:"logout",value:function(){i.a.auth().signOut(),this.router.navigate(["/home"])}},{key:"registerUser",value:function(t){var e=this;i.a.auth().signOut(),this.userAuthInfo=t,console.log(this.userAuthInfo[0],this.userAuthInfo[1]),this.username=this.userAuthInfo[0].slice(0,this.userAuthInfo[0].lastIndexOf("@")),i.a.auth().createUserWithEmailAndPassword(this.userAuthInfo[0],this.userAuthInfo[1]).catch((function(t){var e=t.message;"auth/weak-password"==t.code?alert("the Password is too weak"):alert(e),console.log(t)})),this.firebaseAuth.onAuthStateChanged((function(t){t&&(console.log("REGISTERED SUCCESSFUL:",t),e.router.navigate(["/next"]),e.firestore.collection("ionTennisUsers").doc(t.uid).set({uid:t.uid,email:e.userAuthInfo[0],userName:e.username}).then((function(){console.log("uid: "+t.uid+"was saved in the firestore, thanks"),alert("uid: "+t.uid+", And UserName: "+e.username+" was saved in the firestore, thanks \ud83d\ude0e")})),t.providerData.forEach((function(t){console.log("Sign-in provider: "+t.providerId),console.log("  Provider-specific UID: "+t.uid),console.log("  Name: "+t.displayName),console.log("  Email: "+t.email),console.log(t.email),console.log("  Photo URL: "+t.photoURL)})))}))}},{key:"sendPhotoToStorage",value:function(t){return e=this,r=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.user=i.a.auth().currentUser,this.profileFile=t,console.log(this.profileFile),this.storageRef=i.a.storage().ref(this.user.uid+"/profilePicture/"+this.profileFile.name),this.sendFileTaskObject=this.storageRef.put(this.profileFile),e.next=7,new Promise((function(t,e){return setTimeout(t,1e3)}));case 7:case"end":return e.stop()}}),e,this)})),new((n=void 0)||(n=Promise))((function(t,i){function o(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(t){t(r)}))).then(o,s)}u((r=r.apply(e,[])).next())}));var e,n,r}},{key:"updateProfilePhotoAfterAuth",value:function(t){var e=this;this.user=i.a.auth().currentUser,this.newProfileFile=t,console.log(this.newProfileFile),console.log(this.profileFile.name),this.user&&i.a.storage().ref(this.user.uid+"/profilePicture/"+this.newProfileFile.name).getDownloadURL().then((function(t){console.log(t),e.user.updateProfile({photoURL:t}),alert("Lookin Good ;)"),e.firestore.collection("ionTennisUsers").doc(e.user.uid).update({profilePic:t})}))}},{key:"updateProfileDisplayName",value:function(t){this.user=i.a.auth().currentUser,this.newDisplayName=t,console.log(this.newDisplayName),this.user&&this.user.updateProfile({displayName:this.newDisplayName})}},{key:"getFireStoreData",value:function(){var t=this;this.firestore.collection("ionTennisUsers").get().subscribe((function(e){e.forEach((function(e){t.accountsArray.push(e.data())}))}))}},{key:"getCreepDetails",value:function(t){this.creepDetailsArray=[],this.creepDetailsArray.push(t),console.log(this.creepDetailsArray),this.router.navigate(["/creep"])}},{key:"letsUpdateProfile",value:function(t){this.user=i.a.auth().currentUser,this.editDisplayName=t,this.user&&this.user.updateProfile({displayName:this.editDisplayName})}},{key:"deleteProfile",value:function(){this.user=i.a.auth().currentUser,this.user&&(this.firestore.collection("ionTennisUsers").doc(this.user.uid).delete().then((function(){console.log("Users Informations was deleted from the firestore.")})).catch((function(t){console.log(t)})),this.user.delete().then((function(){alert("You account has been deleted.")})).catch((function(t){console.log(t),alert("there was a error deleting your acount, Sorry!")})))}},{key:"getShotsDetails",value:function(t){var e=this;this.user=i.a.auth().currentUser,console.log(t),this.firestore.collection("ionTennisUsers").doc(this.user.uid).update({lookingToPlay:t[0],profileDescription:t[3]}).then((function(){alert("Cool, Weve got you saved.. Start Finding a partner Today!"),e.router.navigate(["/browse"])}))}},{key:"getUserFirestoreData",value:function(){var t=this;this.user=i.a.auth().currentUser,this.user&&this.firestore.collection("ionTennisUsers").doc(this.user.uid).get().subscribe((function(e){t.indivFireData=e.data(),console.log(t.indivFireData)}))}},{key:"updataUserFirestoreInfo",value:function(t,e){this.user=i.a.auth().currentUser,this.user&&this.firestore.collection("ionTennisUsers").doc(this.user.uid).update({profileDescription:t,lookingToPlay:e})}},{key:"updateBrowseOnViewEnter",value:function(){this.accountsArray=[],this.getFireStoreData()}}]),t}()).\u0275fac=function(t){return new(t||r)(o.Pb(s.a),o.Pb(u.a),o.Pb(a.g),o.Pb(h.a))},r.\u0275prov=o.Eb({token:r,factory:r.\u0275fac,providedIn:"root"}),r)}}])}();